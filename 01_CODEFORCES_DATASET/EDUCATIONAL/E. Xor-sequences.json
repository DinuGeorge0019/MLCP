{"link": "https://codeforces.com//contest/691/problem/E", "problemId": "65090", "problem_idx": "E", "shortId": "691E", "contest_number": "691", "problem_submissions": {"C": [19083647, 19083808, 19079416, 19082359, 19081968, 19086585, 19089942, 19082466, 19085834, 19085017, 19082088, 19085988, 19089031, 19086417, 19086603, 19089268], "F": [19082074, 19086159, 19085359, 19086998, 19087635, 19085577, 19087897, 19088254, 19088045, 19089684, 19089140, 19087588, 19084174, 19089793, 19084959, 19078904, 19079917, 19086444], "E": [19080712, 19082121, 19082381, 19085338, 19084884, 19082001, 19083935, 19084381, 19080694, 19083201, 19085360, 19086298, 19084504, 19094886, 19094230, 19085141, 19083921, 19082714, 19083425, 19082818], "B": [19079418, 19078374, 19077920, 19080120, 19078121, 19077835, 19077976, 19080406, 19082283, 19078348, 19079694, 19081373, 19086345, 19087378, 19087538, 19087384], "D": [19078255, 19080183, 19080970, 19083585, 19083447, 19079074, 19081572, 19083521, 19078743, 19079714, 19083091, 19078918, 19106952, 19081805, 19078693, 19081473, 19084063, 19081536], "A": [19077023, 19078801, 19081051, 19077284, 19076999, 19081615, 19077051, 19078735, 19077123, 19077029, 19083487, 19077036, 19079311, 19086617, 19087885, 19078564]}, "name": "E. Xor-sequences", "statement": "You are given integers .A sequence of integers is called a \"\" if for\r\nevery the number of ones in the binary representation of the number \u2019s\r\nis a multiple of and for all . The symbol is used for the binary\r\nexclusive or operation.How many \"\" of length exist? Output the answer\r\nmodulo .\r\n", "solutions": ["/*\nShe nursed him there, ooh, over a night\nWasn't so sure she wanted him to stay\nWhat to say, what to say\nBut soon she was down, soon he was low\n\nAt a quarter past a holy no\nShe had to turn around\n\nWhen she couldn't hold, oh, she folded\nA dissident is here\nEscape is never the safest path\nOh, a dissident, a dissident is here\n\nAnd to this day, she's glided on\nAlways home but so far away\nLike a word misplaced\nNothing to say, what a waste\n\nWhen she had contact with the conflict\nThere was meanin', but she sold him to the state\nShe had to turn around\n\nWhen she couldn't hold, she folded\nA dissident is here\nEscape is never the safest path\nOh, a dissident, a dissident is here, oh\n\nShe gave him away\nWhen she couldn't hold, no, she folded\nA dissident is here\nEscape is never the safest path\nOh, a dissident, a dissident is here, oh\n\nCouldn't hold on, she couldn't hold, no, she folded\nA dissident is here\nEscape is never the safest place, oh\nA dissident is here\n*/\n\n//#pragma comment(linker, \"/STACK:16777216\")\n#define _CRT_SECURE_NO_WARNINGS\n\n#include <fstream>\n#include <iostream>\n#include <string>\n#include <complex>\n#include <math.h>\n#include <set>\n#include <vector>\n#include <map>\n#include <queue>\n#include <stdio.h>\n#include <stack>\n#include <algorithm>\n#include <list>\n#include <ctime>\n#include <memory.h>\n#include <assert.h>\n\n#define y0 sdkfaslhagaklsldk\n#define y1 aasdfasdfasdf\n#define yn askfhwqriuperikldjk\n#define j1 assdgsdgasghsf\n#define tm sdfjahlfasfh\n#define lr asgasgash\n#define norm asdfasdgasdgsd\n\n#define eps 1e-9\n#define M_PI 3.141592653589793\n#define bs 1000000007\n#define bsize 350\n\nusing namespace std;\n\nconst int INF = 1e9;\nconst int N = 1000031;\n\nvector<vector<long long> > mult(vector<vector<long long> > a, vector<vector<long long> > b)\n{\n\tvector<vector<long long> > res;\n\tres = a;\n\tfor (int i = 0; i < res.size(); i++)\n\t{\n\t\tfor (int j = 0; j < res.size(); j++)\n\t\t{\n\t\t\tres[i][j] = 0;\n\t\t}\n\t}\n\tfor (int k = 0; k < res.size(); k++)\n\t{\n\t\tfor (int i = 0; i < res.size(); i++)\n\t\t{\n\t\t\tfor (int j = 0; j < res.size(); j++)\n\t\t\t{\n\t\t\t\tres[i][j] = (res[i][j] + a[i][k] * b[k][j]) % bs;\n\t\t\t}\n\t\t}\n\t}\n\treturn res;\n}\n\nvector<vector<long long> >pw(vector<vector<long long> > a, long long b)\n{\n\tif (b == 1)\n\t\treturn a;\n\tif (b == 0)\n\t{\n\t\tfor (int i = 0; i < a.size(); i++)\n\t\t{\n\t\t\tfor (int j = 0; j < a.size(); j++)\n\t\t\t{\n\t\t\t\ta[i][j] = (i == j);\n\t\t\t}\n\t\t}\n\t\treturn a;\n\t}\n\n\tif (b % 2)\n\t\treturn mult(a, pw(a, b - 1));\n\treturn pw(mult(a,a), b / 2);\n}\n\nint n;\nlong long k, ar[1000];\n\nint main(){\n\t//freopen(\"fabro.in\",\"r\",stdin);\n\t//freopen(\"fabro.out\",\"w\",stdout);\n\t//freopen(\"F:/in.txt\", \"r\", stdin);\n\t//freopen(\"F:/output.txt\", \"w\", stdout);\n\tios_base::sync_with_stdio(0);\n\t//cin.tie(0);\n\n\tcin >> n >> k;\n\n\tfor (int i = 1; i <= n; i++)\n\t{\n\t\tcin >> ar[i-1];\n\t}\n\n\tvector<vector<long long> > res;\n\tres.resize(n);\n\tfor (int i = 0; i < res.size(); i++)\n\t{\n\t\tres[i].resize(n);\n\t\tfor (int j = 0; j < n; j++)\n\t\t{\n\t\t\tres[i][j] = 0;\n\t\t}\n\t}\n\n\tfor (int i = 0; i < n; i++)\n\t{\n\t\tfor (int j = 0; j < n; j++)\n\t\t{\n\t\t\tlong long val = (ar[i] ^ ar[j]);\n\t\t\tlong long cnt = 0;\n\t\t\tfor (int q = 0; q < 63; q++)\n\t\t\t{\n\t\t\t\tif (val&(1ll << q))\n\t\t\t\t\t++cnt;\n\t\t\t}\n\t\t\tif (cnt % 3 == 0)\n\t\t\t\tres[i][j]++;\n\t\t}\n\t}\n\n\tres = pw(res, k - 1);\n\n\tlong long ans = 0;\n\n\tfor (int i = 0; i < n; i++)\n\t{\n\t\tfor (int j = 0; j < n; j++)\n\t\t{\n\t\t\tans = ans + res[i][j];\n\t\t}\n\t}\n\tcout << ans%bs << endl;\n\n\tcin.get(); cin.get();\n\treturn 0;\n}"], "input": "", "output": "", "tags": ["matrices"], "dificulty": "1900", "interactive": false}