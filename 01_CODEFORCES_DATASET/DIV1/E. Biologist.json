{"link": "https://codeforces.com//contest/311/problem/E", "problemId": "3072", "problem_idx": "E", "shortId": "311E", "contest_number": "311", "problem_submissions": {"D": [3779247, 3776962, 3778512, 3778294, 7187096, 3778596, 3778655, 3779595, 3782423, 3776852, 3786173, 3776817, 3777538, 3777530, 3777687, 3778930, 3778715, 3781988, 3781985, 3780451, 3778559], "C": [3778239, 3780359, 3778509, 3777340, 3780975], "A": [3773410, 3772638, 3772385, 3772049, 3772839, 3772053, 3772233, 3773330, 3772046, 3773286, 3772169, 3772655, 3772327, 3772092, 3778118, 3777958, 3772079, 3772167, 3778901], "B": [3779559, 3776732, 3776480, 3777959, 3776688, 3778706, 3777594, 3778546], "E": [3786260, 3786243, 3779354, 3780972, 3779369]}, "name": "E. Biologist", "statement": "SmallR is a biologist. Her latest research finding is how to change the\r\nsex of dogs. In other words, she can change female dogs into male dogs\r\nand vice versa.She is going to demonstrate this technique. Now SmallR\r\nhas dogs, the costs of each dog\u2019s change may be different. The dogs are\r\nnumbered from 1 to . The cost of change for dog is RMB. By the way, this\r\ntechnique needs a kind of medicine which can be valid for only one day.\r\nSo the experiment should be taken in one day and each dog can be changed\r\nat most once.This experiment has aroused extensive attention from all\r\nsectors of society. There are rich folks which are suspicious of this\r\nexperiment. They all want to bet with SmallR forcibly. If SmallR\r\nsucceeds, the -th rich folk will pay SmallR RMB. But it\u2019s strange that\r\nthey have a special method to determine whether SmallR succeeds. For -th\r\nrich folk, in advance, he will appoint certain dogs and certain one\r\ngender. He will think SmallR succeeds if and only if on some day the\r\nappointed dogs are all of the appointed gender. Otherwise, he will think\r\nSmallR fails.If SmallR can\u2019t satisfy some folk that isn\u2019t her friend,\r\nshe need not pay him, but if someone she can\u2019t satisfy is her good\r\nfriend, she must pay RMB to him as apologies for her fail.Then, SmallR\r\nhope to acquire money as much as possible by this experiment. Please\r\nfigure out the maximum money SmallR can acquire. By the way, it is\r\npossible that she can\u2019t obtain any money, even will lose money. Then,\r\nplease give out the minimum money she should lose.\r\n", "solutions": ["#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<algorithm>\n#include<cstring>\n#include<cmath>\n#include<ctime>\n#include<map>\n#include<string>\n#include<vector>\n#include<set>\n\nusing namespace std;\n#define For(i,l,r) for (int i = l; i <= r; ++i)\n#define Cor(i,l,r) for (int i = l; i >= r; --i)\n#define Fill(a,b) memset(a,b,sizeof(a))\n#define FI first\n#define SE second\n#define MP make_pair\n#define PII pair<int,int>\n#define flt double\n#define INF (0x3f3f3f3f)\n#define MaxN 1020304\n#define MaxNode 1020304\n#define MD 1000000007\n\nstruct Tflow {\n    int v[MaxN],next[MaxN],h[MaxN],tot,c[MaxN];\n    void clr() { Fill(h,tot = 0); }\n    void add(int b,int e,int f) { //cerr << b << ' ' << e << ' ' << f << endl;\n        v[++tot] = e; next[tot] = h[b]; h[b] = tot; c[tot] = f;\n        v[++tot] = b; next[tot] = h[e]; h[e] = tot; c[tot] = 0;\n    }\n    int S,T,d[MaxN],flow,found,gap[MaxN],cur[MaxN],ans;\n    void aug(int i) {\n        if (i == T) {\n            ans += flow; found = true;\n            return ;\n        }\n        int mind = T, tf = flow, z;\n        for (z = cur[i]; z; z = next[z]) if (c[z]) {\n            if (d[v[z]] + 1 == d[i]) {\n                flow = min(flow,c[z]); cur[i] = z;\n                aug(v[z]);\n                if (found) break ; if (d[S] >= T) return ;\n                flow = tf; \n            } mind = min(mind,d[v[z]]);\n        }\n        if (found) {\n            c[z] -= flow; c[(z & 1) ? (z + 1) : (z - 1)] += flow;\n        } else {\n            if (--gap[d[i]] == 0) d[S] = T;\n            for (int z = h[i]; z; z = next[z]) if (c[z]) mind = min(mind,d[v[z]]);\n            ++gap[d[i] = mind + 1]; cur[i] = h[i];\n        }\n    }\n    void isap() {\n        ans = 0; Fill(d,0); Fill(gap,0); gap[0] = T; For(i,1,T) cur[i] = h[i];\n        while (d[S] < T) {\n            flow = INF; found = false ;\n            aug(S);\n        }\n    }\n    int Sol(int _s,int _t) {\n        S = _s; T = _t;\n        isap();\n        return ans;\n    }\n} TF;\n\nint n,m,g,gen[MaxN],c[MaxN];\nint main() {\n    //freopen(\"input.txt\",\"r\",stdin); freopen(\"output.txt\",\"w\",stdout);\n    cin >> n >> m >> g;\n    For(i,1,n) scanf(\"%d\",&gen[i]); TF.clr();\n    int S = n + m + 1, T = S + 1;\n    For(i,1,n) {\n        scanf(\"%d\",&c[i]);\n        if (gen[i]) TF.add(S,i,c[i]); else TF.add(i,T,c[i]);\n    }\n    int ans = 0;\n    For(i,1,m) {\n            int ng,c,k,f;\n        scanf(\"%d%d%d\",&ng,&c,&k);\n        For(j,1,k) {\n                int q;\n            scanf(\"%d\",&q);\n            if (ng) TF.add(n + i,q,INF);\n            else TF.add(q,n + i,INF);\n        }\n        scanf(\"%d\",&f);\n        ans += c; if (f) c += g;\n        if (ng) TF.add(S,n + i,c); else TF.add(n + i,T,c);\n    }\n    int Ans = ans - TF.Sol(S,T);\n    cout << Ans << endl;\n    return 0;\n}\n"], "input": "", "output": "", "tags": ["flows"], "dificulty": "2300", "interactive": false}