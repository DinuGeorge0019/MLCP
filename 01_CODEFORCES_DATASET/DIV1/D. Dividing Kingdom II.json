{"link": "https://codeforces.com//contest/687/problem/D", "problemId": "63913", "problem_idx": "D", "shortId": "687D", "contest_number": "687", "problem_submissions": {"E": [18802309, 18806260, 18805246, 18803372, 18799334, 18807280, 18805272, 18806337, 18807252, 18806390, 18807620, 18803706, 18810595, 18816088, 18805681], "D": [18793799, 18802718, 18796900, 18797754, 18807683, 18798362, 18797604, 18800141, 18800702, 18803058, 18801619, 18800190, 18801266, 18807597, 18797518, 18800453, 18798281], "A": [18790806, 18786960, 18787408, 18787163, 18787741, 18788893, 18788129, 18787797, 18786842, 18788168, 18789518, 18787023, 18787148, 18787130, 18787967, 18788569, 18787232, 18787389], "C": [18788685, 18790045, 18790813, 18791514, 18792644, 18791092, 18793279, 18795089, 18793603, 18792159, 18795767, 18790356, 18792828, 18792310, 18792853, 18794074, 18789915, 18792958], "B": [18786970, 18788540, 18789247, 18789185, 18796167, 18786909, 18790772, 18789737, 20295221, 20295216, 20295180, 20295158, 20295119, 20295105, 18790246, 18790367, 18793463, 18789273, 20295043, 20295033, 20295023, 20295001, 20294990, 20292826, 18789797, 18790852, 18792280, 18796842, 18789369]}, "name": "D. Dividing Kingdom II", "statement": "Long time ago, there was a great kingdom and it was being ruled by The\r\nGreat Arya and Pari The Great. These two had some problems about the\r\nnumbers they like, so they decided to divide the great kingdom between\r\nthemselves.The great kingdom consisted of cities numbered from to and\r\nbidirectional roads between these cities, numbered from to . The -th\r\nroad had length equal to . The Great Arya and Pari The Great were\r\ndiscussing about destructing some prefix (all road with numbers less\r\nthan some ) and suffix (all roads with numbers greater than some ) of\r\nthe roads so there will remain only the roads with numbers and .After\r\nthat they will divide the great kingdom into two pieces (with each city\r\nbelonging to exactly one piece) such that the of the division is . The\r\nhardness of a division is the of a road such that its both endpoints are\r\nin the same piece of the kingdom. In case there is no such road, the\r\nhardness of the division is considered to be equal to .Historians found\r\nthe map of the great kingdom, and they have guesses about the and chosen\r\nby those great rulers. Given these data, for each guess and print the\r\nminimum possible hardness of the division of the kingdom.\r\n", "solutions": ["#include <cstdio>\n#include <cstring>\n#include <cmath>\n#include <algorithm>\n#include <vector>\n#include <string>\n#include <map>\n#include <set>\n#include <cassert>\nusing namespace std;\n#define rep(i,a,n) for (int i=a;i<n;i++)\n#define per(i,a,n) for (int i=n-1;i>=a;i--)\n#define pb push_back\n#define mp make_pair\n#define all(x) (x).begin(),(x).end()\n#define fi first\n#define se second\n#define SZ(x) ((int)(x).size())\ntypedef vector<int> VI;\ntypedef long long ll;\ntypedef pair<int,int> PII;\nconst ll mod=1000000007;\nll powmod(ll a,ll b) {ll res=1;a%=mod; assert(b>=0); for(;b;b>>=1){if(b&1)res=res*a%mod;a=a*a%mod;}return res;}\n// head\n\nint n,m,q,u,v,w,l,r,f[2010];\nvector<pair<int,pair<PII,int> > > e;\nint find(int x) { return f[x]==x?x:f[x]=find(f[x]); }\nint main() {\n\tscanf(\"%d%d%d\",&n,&m,&q);\n\trep(i,0,m) {\n\t\tscanf(\"%d%d%d\",&u,&v,&w);\n\t\t--u; --v;\n\t\te.pb(mp(w,mp(mp(u,v),i+1)));\n\t}\n\tsort(all(e)); reverse(all(e));\n\trep(i,0,q) {\n\t\tscanf(\"%d%d\",&l,&r);\n//\t\t--l; --r;\n\t\trep(j,0,2*n) f[j]=j;\n\t\tbool val=1;\n\t\trep(j,0,m) if (e[j].se.se>=l&&e[j].se.se<=r) {\n\t\t\tu=e[j].se.fi.fi,v=e[j].se.fi.se;\n//\t\t\tprintf(\"%d %d\\n\",u,v);\n\t\t\tif (find(2*u)==find(2*v)) {\n\t\t\t\tprintf(\"%d\\n\",e[j].fi);\n\t\t\t\tval=0;\n\t\t\t\tbreak;\n\t\t\t} else {\n\t\t\t\tf[find(2*u)]=find(2*v+1);\n\t\t\t\tf[find(2*u+1)]=find(2*v);\n\t\t\t}\n\t\t}\n\t\tif (val==1) {\n\t\t\tputs(\"-1\");\n\t\t}\n\t}\n}\n"], "input": "", "output": "", "tags": ["brute force", "data structures", "dsu", "graphs", "sortings"], "dificulty": "2500", "interactive": false}