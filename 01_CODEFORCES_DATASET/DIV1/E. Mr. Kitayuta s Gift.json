{"link": "https://codeforces.com//contest/506/problem/E", "problemId": "20824", "problem_idx": "E", "shortId": "506E", "contest_number": "506", "problem_submissions": {"C": [9464348, 9463979, 9557239, 9466208, 9514381], "D": [9461125, 9461876, 9460334, 9459573, 9458109, 9460700, 9459375, 9461634, 9460457, 9461910, 9458643, 9460232, 9462018, 9462258, 9460016, 9460009, 9459977, 9462409, 9460765], "B": [9459503, 9458315, 9457879, 9457557, 9459219, 9458249, 9461319, 9459208, 9457985, 9457950, 9462161, 9459453, 9458782, 9461373, 9462464, 9462819, 9459210, 9458536], "A": [9456602, 9456438, 9456462, 9456507, 9460135, 9456591, 9456641, 9456514, 9463082, 9456214, 9463955, 9457315, 9456528, 9457236, 9463962, 9457919, 9457204, 9456634, 9464389], "E": [9557214]}, "name": "E. Mr. Kitayuta s Gift", "statement": "Mr. Kitayuta has kindly given you a string consisting of lowercase\r\nEnglish letters. You are asked to insert exactly lowercase English\r\nletters into to make it a palindrome. (A is a string that reads the same\r\nforward and backward. For example, \"\", \"\" and \"\" are all palindromes,\r\nwhile \"\" and \"\" are not.) You can choose any lowercase English letters,\r\nand insert each of them to any position of , possibly to the beginning\r\nor the end of . You have to insert exactly letters even if it is\r\npossible to turn into a palindrome by inserting less than letters.Find\r\nthe number of the palindromes that can be obtained in this way, modulo .\r\n", "solutions": ["#include <algorithm>\n#include <cstring>\n#include <cstdlib>\n#include <cstdio>\n#include <vector>\n#include <ctime>\n#define fi first\n#define se second\n#define PA pair<int,int>\n#define VI vector<int>\n#define VP vector<PA >\n#define mk(x,y) make_pair(x,y)\n#define N 210\n#define M N*2\n#define mo 10007\n#define For(i,x,y) for (i=x;i<=y;i++)\nusing namespace std;\nint i,j,k,n,m,nn,an;\nint a[M][M],b[M][M],f[N][N][N];\nchar p[N];\ninline void mul(int a[M][M],int b[M][M]) {\n\tint i,j,k,c[M][M]={};\n\tFor(i,1,nn)For(j,i,nn)For(k,j,nn) c[i][k]=(a[i][j]*b[j][k]+c[i][k])%mo;\n\tFor(i,1,nn)For(j,i,nn) a[i][j]=c[i][j];\n}\ninline void S(int &x,int y) {\n\tx=(x+y)%mo;\n}\ninline void pre() {\n\tint i,j,k,u,x;\n\tf[1][m][0]=1;\n\tfor (i=m-1;i>=0;i--) For(j,1,m-i) For(k,0,m) {\n\t\tu=j+i;\n\t\tif ((x=f[j][u][k])>0) {\n\t\t\tif (p[j]==p[u]) S(f[j+1][u-1][k],x);\n\t\t\telse S(f[j+1][u][k+1],x),S(f[j][u-1][k+1],x);\n\t\t}\n\t}\n}\nint main() {\n\tscanf(\"%s%d\",p+1,&n);\n\tm=strlen(p+1);\n\tpre();\n\tn+=m;\n\tint flag=n&1;\n\tn/=2;\n\tint n24=m,n25=(m+1)/2,n26=n25+1;\n\tnn=n24+n25+n26;\n\tFor(i,1,n24+n25-1) a[i][i+1]=1;\n\tFor(i,0,n25) a[n24+i][nn-i]=1;\n\tFor(i,1,n24) a[i][i]=24;\n\tFor(i,1,n25) a[n24+i][n24+i]=25;\n\tFor(i,1,n26) a[n24+n25+i][n24+n25+i]=26;\n\tFor(i,1,nn) b[i][i]=1;\n\tfor (k=n;k;k/=2) {\n\t\tif (k&1) mul(b,a);\n\t\tmul(a,a);\n\t}\n\tFor(i,0,m) {\n\t\tint v24=i,v25=(m-i+1)/2,s=0;\n\t\tFor(j,1,m) S(s,f[j+1][j-1][i]),S(s,f[j][j-1][i]);\n\t\tan=(s*b[n24-v24+1][nn-v25]%mo*(flag?26:1)+an)%mo;\n\t\t\n\t\tif (flag&&(m-v24)%2==1) {\n\t\t\ts=0;\n\t\t\tFor(j,1,m) S(s,f[j][j][i]);\n\t\t\tan=(s*b[n24-v24+1][n24+v25]+an)%mo;\n\t\t}\n\t}\n\tprintf(\"%d\\n\",an);\n\treturn 0;\n}\n"], "input": "", "output": "", "tags": ["combinatorics", "dp", "matrices", "strings"], "dificulty": "3000", "interactive": false}