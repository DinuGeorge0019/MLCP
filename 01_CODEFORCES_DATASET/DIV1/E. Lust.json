{"link": "https://codeforces.com//contest/891/problem/E", "problemId": "134544", "problem_idx": "E", "shortId": "891E", "contest_number": "891", "problem_submissions": {"D": [32405811, 32403732, 32402138, 32430714, 32405646], "B": [32397173, 32384884, 32383268, 32389067, 32402095, 32392144, 32390145, 32392706, 32386797, 32391950, 32394619, 32391275, 32387784, 32402908, 32394168, 32390852, 32393424, 32402498, 32390071, 32396268], "C": [32396218, 32388086, 32389360, 32395431, 32392168, 32396723, 32397239, 32390965, 32393675, 32398647, 32398521, 32396975, 32390007, 32404522, 32396953, 32387277, 32386884, 32403069], "A": [32391368, 32389450, 32385263, 32382597, 32388551, 32393309, 32385252, 32391318, 32384125, 32393321, 32386822, 32382673, 32385160, 32385074, 32382459, 32389480, 32400282, 32382452, 32383065], "E": [32389900, 32397841, 32401538, 32399718, 32400691, 32399515, 32401892, 32401660, 32405427, 32400764, 32394075, 32405328, 32405995, 32402118, 32511522, 32397327]}, "name": "E. Lust", "statement": "You are given a sequence containing integers. There is a variable that\r\nis equal to initially. The following process repeats times.Choose an\r\nindex from to uniformly at random. Name it . Add to the multiply of all\r\n\u2019s such that , but . Then, subtract by .You have to find expected value\r\nof at the end of the process. It can be proved that the expected value\r\nof can be represented as an irreducible fraction . You have to find .\r\n", "solutions": ["#include <cstdio>\n#include <cstring>\n#include <cmath>\n#include <algorithm>\n#include <vector>\n#include <string>\n#include <map>\n#include <set>\n#include <cassert>\nusing namespace std;\n#define rep(i,a,n) for (int i=a;i<n;i++)\n#define per(i,a,n) for (int i=n-1;i>=a;i--)\n#define pb push_back\n#define mp make_pair\n#define all(x) (x).begin(),(x).end()\n#define fi first\n#define se second\n#define SZ(x) ((int)(x).size())\ntypedef vector<int> VI;\ntypedef long long ll;\ntypedef pair<int,int> PII;\nconst ll mod=1000000007;\nll powmod(ll a,ll b) {ll res=1;a%=mod; assert(b>=0); for(;b;b>>=1){if(b&1)res=res*a%mod;a=a*a%mod;}return res;}\n// head\n\nconst int N=10100;\nint n;\nll poly[N],q[N],ret[N],k,ans;\nint a[N];\nint main() {\n\tscanf(\"%d%lld\",&n,&k);\n\tpoly[0]=1;\n\trep(i,0,n) {\n\t\tscanf(\"%d\",a+i);\n\t\tper(j,0,i+1) poly[j+1]=(poly[j]+poly[j+1])%mod,poly[j]=poly[j]*(mod-a[i])%mod;\n\t}\n\trep(i,0,n) {\n\t\tper(j,0,n+1) q[j]=poly[j];\n\t\tper(j,1,n+1) {\n\t\t\tret[j-1]=(ret[j-1]+q[j])%mod;\n\t\t\tq[j-1]=(q[j-1]+q[j]*a[i])%mod;\n\t\t}\n\t}\n\tll coef=1;\n\trep(i,0,n) {\n\t\tcoef=coef*(k-i)%mod;\n\t\tans=(ans+powmod(n,mod-2-i)%mod*coef%mod*powmod(i+1,mod-2)%mod*ret[i])%mod;\n\t}\n\tans=ans*powmod(mod-1,n+1)%mod;\n\tprintf(\"%lld\\n\",ans);\n}\n"], "input": "", "output": "", "tags": ["combinatorics", "math", "matrices"], "dificulty": "3000", "interactive": false}