{"link": "https://codeforces.com//contest/819/problem/D", "problemId": "112026", "problem_idx": "D", "shortId": "819D", "contest_number": "819", "problem_submissions": {"E": [28095868, 28093903, 28090933, 28090593, 28094491, 28097177, 28097247, 28091454, 28092476, 28096909, 28091607, 28092950, 28099143, 28090256, 28093515, 28093604, 28090845, 28094347], "D": [28094321, 28096368, 28099459, 28093095, 28099589, 28093948, 28092918, 28100416, 28094247, 28087916, 31892342, 28089013], "C": [28089679, 28092136, 28087482, 28107336, 28092204, 28092623, 28096714, 79507001, 28096230, 31884749], "B": [28083507, 28085088, 28080609, 28088461, 28084942, 31697997, 28085544, 28084735, 28088088, 28084884, 28083914, 127584112, 127584041, 28087562, 28081410, 28095682, 28086459, 28088790, 28094207, 28087593, 28085906], "A": []}, "name": "D. Mister B and Astronomers", "statement": "After studying the beacons Mister B decided to visit alien\u2019s planet,\r\nbecause he learned that they live in a system of flickering star Moon.\r\nMoreover, Mister B learned that the star shines once in exactly seconds.\r\nThe problem is that the star is yet to be discovered by scientists.There\r\nare astronomers numerated from to trying to detect the star. They try to\r\ndetect the star by sending requests to record the sky for second. The\r\nastronomers send requests : the -th astronomer sends a request exactly\r\nsecond after the -th (i.e. if the previous request was sent at moment ,\r\nthen the next request is sent at moment ); the -st astronomer sends\r\nrequests seconds later than the -th. The first astronomer sends his\r\nfirst request at moment .Mister B doesn\u2019t know the first moment the star\r\nis going to shine, but it\u2019s obvious that all moments at which the star\r\nwill shine are determined by the time of its shine moment in the\r\ninterval . Moreover, this interval can be split into parts of second\r\nlength each of form , where .Mister B wants to know how lucky each\r\nastronomer can be in discovering the star first.For each astronomer\r\ncompute how many segments of form () there are in the interval so that\r\nthis astronomer is the first to discover the star if the first shine of\r\nthe star happens in this time interval.\r\n", "solutions": ["#include<iostream>\n#include<cmath>\n#include<cstdio>\n#include<algorithm>\n#include<cstring>\n#include<map>\nusing namespace std;\nint aa[210000],T,n,step;\nlong long pre[210000],L;\nmap<int,int>M;\nvector<int>A[2100000];\nint B[210000],C[210000];\nint len=0,ans[210000],t[210000],fir[210000],c[210000];\nlong long a,b;\nlong long exgcd(long long k1,long long k2)\n{\n\tif (k2==0) {a=1; b=0; return k1;}\n\tlong long k3=exgcd(k2,k1%k2),k4=a;\n\ta=b; b=k4-(k1/k2)*b; return k3;\n}\nint compare(int k1,int k2){\n\treturn fir[k1]<fir[k2];\n}\nvoid solve(vector<int>&A){\n\tint n=0;\n\tM.clear(); \n\tfor (int i=0;i<A.size();i++){\n\t\tint k=pre[A[i]]%T;\n\t\tif (M[k]) continue;\n\t\tn++; B[n]=A[i],C[n]=pre[A[i]]%T; M[k]=1;\n\t}\n\tfor (int i=1;i<=n;i++){\n\t\tlong long d=exgcd(step,T);\n\t\tint c=C[i]-C[1];\n\t\tlong long inc=T/d;\n\t\ta%=inc;\n\t\twhile (a>=0) a-=inc;\n\t\twhile (a<0) a+=inc;\n\t\ta*=c/d; a%=inc;\n\t\twhile (a>=0) a-=inc;\n\t\twhile (a<0) a+=inc;\n\t\tfir[i]=a;\n\t}\n//\tcout<<\"solve\"<<endl;\n//\tfor (int i=1;i<=n;i++) cout<<B[i]<<\" \"<<C[i]<<\" \"<<fir[i]<<endl;\n\tfor (int i=1;i<=n;i++) c[i]=i;\n\tsort(c+1,c+n+1,compare);\n\tc[n+1]=0; fir[0]=T/__gcd(L,(long long)T);\n\tfor (int i=1;i<=n;i++) ans[B[c[i]]]=fir[c[i+1]]-fir[c[i]];\n}\nint main(){\n\tscanf(\"%d%d\",&T,&n);\n\tfor (int i=1;i<=n;i++) scanf(\"%d\",&aa[i]); aa[n+1]=aa[1];\n\tfor (int i=1;i<=n;i++) pre[i+1]=pre[i]+aa[i+1];\n\tL=pre[n+1];\n\tint w=__gcd(L,(long long)T);\n\tstep=L%T;\n\tfor (int i=1;i<=n;i++){\n\t\tint where=pre[i]%w;\n\t\tif (M[where]==0){\n\t\t\tM[where]=++len; \n\t\t}\n\t\twhere=M[where];\n\t\tA[where].push_back(i);\n\t}\n\tfor (int i=1;i<=len;i++) solve(A[i]);\n\tfor (int i=1;i<=n;i++) printf(\"%d \",ans[i]); printf(\"\\n\");\n}\n\t"], "input": "", "output": "", "tags": ["number theory"], "dificulty": "2900", "interactive": false}