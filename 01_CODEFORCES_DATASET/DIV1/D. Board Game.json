{"link": "https://codeforces.com//contest/605/problem/D", "problemId": "42720", "problem_idx": "D", "shortId": "605D", "contest_number": "605", "problem_submissions": {"C": [14733414, 14720384, 14720999, 14727321, 14722464, 14721634, 14727835, 14731363, 14731595, 14730092, 14726129, 14721720, 14724282, 14722284, 14722209, 14728049], "D": [14724788, 14728609, 14730065, 14729000, 14724493, 14732219, 14728421, 14723804, 14721730, 14724221, 14732566, 14780111, 14732774, 14732416, 14730015, 14724377], "A": [14722715, 14715950, 14715817, 14716990, 14715828, 14715926, 14717224, 14715773, 14715784, 14715907, 14716365, 14720150, 14715839, 14716429, 14716499, 14716967, 14715831, 14715776], "B": [14721948, 14718121, 14718105, 14718689, 14718666, 14718313, 14719575, 14717722, 14717902, 14718552, 14718421, 14718419, 14718059, 14719671, 14718443, 14719771, 14718528, 14719776], "E": [14718635, 14725044, 14723153, 14726864, 14729961, 14722181, 14723791, 14727330, 14729035, 14727305, 14723008, 14728473, 14728113, 14731024, 14729704, 14736246, 14736224]}, "name": "D. Board Game", "statement": "You are playing a board card game. In this game the player has two\r\ncharacteristics, and the white magic skill and the black magic skill,\r\nrespectively. There are spell cards lying on the table, each of them has\r\nfour characteristics, , , and . In one move a player can pick one of the\r\ncards and cast the spell written on it, but only if first two of it\u2019s\r\ncharacteristics meet the requirement and , i.e. if the player has enough\r\nmagic skill to cast this spell. However, after casting the spell the\r\ncharacteristics of a player change and become equal to and .At the\r\nbeginning of the game both characteristics of a player are equal to\r\nzero. The goal of the game is to cast the -th spell. Your task is to\r\nmake it in as few moves as possible. You are allowed to use spell in any\r\norder and any number of times (for example, you may not use some spells\r\nat all).\r\n", "solutions": ["#include <cstdio>\n#include <cstring>\n#include <cmath>\n#include <algorithm>\n#include <vector>\n#include <string>\n#include <map>\n#include <set>\n#include <cassert>\nusing namespace std;\n#define rep(i,a,n) for (int i=a;i<n;i++)\n#define per(i,a,n) for (int i=n-1;i>=a;i--)\n#define pb push_back\n#define mp make_pair\n#define all(x) (x).begin(),(x).end()\n#define fi first\n#define se second\n#define SZ(x) ((int)(x).size())\ntypedef vector<int> VI;\ntypedef long long ll;\ntypedef pair<int,int> PII;\nconst ll mod=1000000007;\nll powmod(ll a,ll b) {ll res=1;a%=mod;for(;b;b>>=1){if(b&1)res=res*a%mod;a=a*a%mod;}return res;}\n// head\n\nconst int N=201000;\nint n,a[N],b[N],c[N],d[N],e[N],dis[N],vis[N],pre[N],q[N],m;\nVI vx,vy,dd;\nset<PII> cc[N];\nvoid modify(int x,PII s) {\n\tfor (;x<=m;x+=x&-x) cc[x].insert(s);\n}\nvoid query(int x,int v) {\n\tdd.clear();\n\tfor (;x;x-=x&-x) {\n\t\twhile (1) {\n\t\t\tauto it=cc[x].lower_bound(mp(v,-1));\n\t\t\tif (it==cc[x].end()) break;\n\t\t\tdd.pb(it->se);\n\t\t\tcc[x].erase(it);\n\t\t}\n\t}\n}\nvoid print(int u) {\n\tprintf(\"%d\\n\",dis[u]+1);\n\tfor (;u!=-1;u=pre[u]) {\n\t\tprintf(\"%d \",u+1);\n\t}\n\tputs(\"\");\n}\nint main() {\n\tscanf(\"%d\",&n);\n\trep(i,0,n) scanf(\"%d%d%d%d\",a+i,b+i,c+i,d+i),vx.pb(a[i]),vx.pb(c[i]),vy.pb(b[i]),vy.pb(d[i]);\n\tsort(all(vx)); sort(all(vy));\n\tif (vx[0]!=0||vy[0]!=0) {\n\t\tputs(\"-1\");\n\t\treturn 0;\n\t}\n\trep(i,0,n) vis[i]=0;\n\tvis[n-1]=1; q[0]=n-1; pre[n-1]=-1;\n\tm=SZ(vx);\n\trep(i,0,n) {\n\t\te[i]=m-(lower_bound(vx.begin(),vx.end(),a[i])-vx.begin());\n\t\tc[i]=m-(lower_bound(vx.begin(),vx.end(),c[i])-vx.begin());\n\t\tmodify(c[i],mp(d[i],i));\n\t}\n\tint t=1;\n\trep(i,0,t) {\n\t\tint u=q[i];\n\t\tif (a[u]==0&&b[u]==0) {\n\t\t\tprint(u);\n\t\t\treturn 0;\n\t\t}\n\t\tquery(e[u],b[u]);\n\t\tfor (auto v:dd) {\n\t\t\tif (vis[v]) continue;\n\t\t\tdis[v]=dis[u]+1; vis[v]=1;\n\t\t\tpre[v]=u; q[t++]=v;\n\t\t}\n\t}\n\tputs(\"-1\");\n}\n"], "input": "", "output": "", "tags": ["data structures", "dfs and similar"], "dificulty": "2500", "interactive": false}