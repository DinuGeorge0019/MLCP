{"link": "https://codeforces.com//contest/917/problem/D", "problemId": "151490", "problem_idx": "D", "shortId": "917D", "contest_number": "917", "problem_submissions": {"C": [34680068, 34681336, 34678312, 34684700, 34684340, 34684129, 34684130, 34686499, 34795938, 34730488, 34696787], "A": [34673920, 34665747, 34666503, 34668041, 34667604, 34679203, 34668301, 34677179, 34678218, 34682551, 34666784, 34671651, 34681613, 34668433, 34679190, 34665183, 34667188, 34667822, 34678091, 34668342], "B": [34672970, 34673451, 34671200, 34673043, 34673517, 34672805, 34670705, 34675348, 34676012, 34676530, 34670452, 34673092, 34671413, 34673682, 34678568, 34669943, 34672667, 34674568, 34678107, 34670900], "D": [34670187, 34675817, 34681965, 34679140, 34679490, 34676721, 34681020, 34673182, 34673535, 34673684, 34678521, 34677964, 34675981, 34677937, 34674919, 37086325, 34680194, 34680489, 34679577, 34678015, 34681680], "E": [38254406, 38253558, 38252911]}, "name": "D. Stranger Trees", "statement": "Will shares a psychic connection with the Upside Down Monster, so\r\neverything the monster knows, Will knows. Suddenly, he started drawing,\r\npage after page, non-stop. Joyce, his mom, and Chief Hopper put the\r\ndrawings together, and they realized, it\u2019s a labeled tree! A tree is a\r\nconnected acyclic graph. Will\u2019s tree has vertices. Joyce and Hopper\r\ndon\u2019t know what that means, so they\u2019re investigating this tree and\r\nsimilar trees. For each such that , they\u2019re going to investigate all\r\nlabeled trees with vertices that share exactly edges with Will\u2019s tree.\r\nTwo labeled trees are different if and only if there\u2019s a pair of\r\nvertices such that there\u2019s an edge between and in one tree and not in\r\nthe other one.Hopper and Joyce want to know how much work they have to\r\ndo, so they asked you to tell them the number of labeled trees with\r\nvertices that share exactly edges with Will\u2019s tree, for each . The\r\nanswer could be very large, so they only asked you to tell them the\r\nanswers modulo .\r\n", "solutions": ["#include <bits/stdc++.h>\nusing namespace std;\n#define rep(i,a,n) for (int i=a;i<n;i++)\n#define per(i,a,n) for (int i=n-1;i>=a;i--)\n#define pb push_back\n#define mp make_pair\n#define all(x) (x).begin(),(x).end()\n#define fi first\n#define se second\n#define SZ(x) ((int)(x).size())\ntypedef vector<int> VI;\ntypedef long long ll;\ntypedef pair<int,int> PII;\nconst ll mod=1000000007;\nll powmod(ll a,ll b) {ll res=1;a%=mod; assert(b>=0); for(;b;b>>=1){if(b&1)res=res*a%mod;a=a*a%mod;}return res;}\nll gcd(ll a,ll b) { return b?gcd(b,a%b):a;}\n// head\n\nconst int N=110;\nint n,u,v,gg[N][N];\nll f[N][N],ff[N];\nll det() {\n\tll ans=1;\n\trep(i,1,n) {\n\t\tbool fg=0;\n\t\trep(j,i,n) if (f[j][i]!=0) {\n\t\t\trep(k,i,n) swap(f[i][k],f[j][k]);\n\t\t\tif (j!=i) ans=-ans;\n\t\t\tfg=1;\n\t\t\tbreak;\n\t\t}\n\t\tif (!fg) return 0;\n\t\trep(j,i+1,n) {\n\t\t\tll tmp=-f[j][i]*powmod(f[i][i],mod-2)%mod;\n\t\t\trep(k,i,n) f[j][k]=(f[j][k]+tmp*f[i][k])%mod;\n\t\t}\n\t\t\n\t}\n\trep(i,1,n) ans=ans*f[i][i]%mod;\n\tif (ans<0) ans+=mod;\n\treturn ans;\n}\n\nll inv[N],g[N],c[N],w[N];\nint main() {\n\tscanf(\"%d\",&n);\n\trep(i,1,n) {\n\t\tscanf(\"%d%d\",&u,&v);\n\t\t--u; --v;\n\t\tgg[u][v]=gg[v][u]=1;\n\t}\n\trep(x,0,n+1) {\n\t\trep(i,0,n) f[i][i]=0;\n\t\trep(i,0,n) rep(j,0,n) if (i!=j) {\n\t\t\tf[i][j]=-(gg[i][j]?x:1);\n\t\t\tf[i][i]-=f[i][j];\n\t\t}\n\t\tff[x]=det();\n\t}\n\tinv[0]=inv[1]=1;\n\tfor (int i=2;i<=n;i++) inv[i]=mod-(inv[mod%i]*(mod/i))%mod;\n\tg[0]=g[1]=1;\n\tfor (int i=2;i<=n;i++) g[i]=g[i-1]*inv[i]%mod;\n\tfor (int i=0;i<=n;i++) w[i]=powmod(i,n);\n\tfor (int i=n;i>=0;i--) {\n\t\tfor (int j=0;j<=i;j++) {\n\t\t\tif (j&1) {\n\t\t\t\tc[i]-=g[j]*g[i-j]%mod*ff[i-j]%mod;\n\t\t\t\tif (c[i]<0) c[i]+=mod;\n\t\t\t} else {\n\t\t\t\tc[i]+=g[j]*g[i-j]%mod*ff[i-j]%mod;\n\t\t\t\tif (c[i]>=mod) c[i]-=mod;\n\t\t\t}\n\t\t}\n\t\tfor (int j=1;j<=n;j++) {\n\t\t\tff[j]-=c[i]*w[j]%mod;\n\t\t\tif (ff[j]<0) ff[j]+=mod;\n\t\t\tw[j]=w[j]*inv[j]%mod;\n\t\t}\n\t}\n\trep(i,0,n) printf(\"%lld \",c[i]); puts(\"\");\n}\n"], "input": "", "output": "", "tags": ["dp", "math", "matrices", "trees"], "dificulty": "2600", "interactive": false}