{"link": "https://codeforces.com//contest/446/problem/E", "problemId": "11403", "problem_idx": "E", "shortId": "446E", "contest_number": "446", "problem_submissions": {"D": [7086133, 7088502, 7303572, 7094524, 7087369, 7108964, 7108953, 7108945, 7108928, 7108912, 7089186, 7086153, 7256786, 7256781, 7111708], "B": [7082083, 7079232, 7078714, 7083465, 7077013, 7081087, 7303292, 7079381, 7081269, 7080767, 7080268, 7085675, 7089437, 7079048, 7081011, 7082061, 7081382, 7083005, 7082149], "C": [7079856, 7085393, 7084759, 7079794, 7695226, 7082368, 7303421, 7094356, 7085833, 7086068, 7088271, 7087032, 7088166, 7086187, 7087998, 7087654, 7091193, 7088707], "A": [7075913, 7076352, 7074747, 7080779, 7084765, 7075635, 7303252, 7075476, 7075873, 7075184, 7076974, 7078214, 7075141, 7075542, 7077127, 7075653, 7075563, 7076924, 7075972], "E": [7093796, 7093681]}, "name": "E. DZY Loves Bridges", "statement": "DZY owns islands near his home, numbered from to . He loves building\r\nbridges to connect the islands. Every bridge he builds takes one day\u2019s\r\ntime to walk across.DZY has a strange rule of building the bridges. For\r\nevery pair of islands , he has built different bridges connecting them,\r\nwhere ( means is divisible by ). These bridges are bidirectional.Also,\r\nDZY has built some bridges connecting his home with the islands.\r\nSpecifically, there are different bridges from his home to the -th\r\nisland. These are one-way bridges, so after he leaves his home he will\r\nnever come back.DZY decides to go to the islands for sightseeing. At\r\nfirst he is at home. He chooses and walks across one of the bridges\r\nconnecting with his home, and arrives at some island. After that, he\r\nwill spend day(s) on the islands. Each day, he can choose to stay and\r\nrest, or to walk to another island across the bridge. It is allowed to\r\nstay at an island for more than one day. It\u2019s also allowed to cross one\r\nbridge more than once.Suppose that right after the -th day DZY stands at\r\nthe -th island. Let be the number of ways for DZY to reach the -th\r\nisland after -th day. Your task is to calculate for each modulo .\r\n", "solutions": ["#include <stdio.h>\n#include <memory.h>\ntypedef __int64 ll;\n#define mod 1051131\n#define M 26\n#define N 1+(1<<25)\n\nint n,m;\nll t;\nint a[M],b[M],c[M];\nint y[N], f[N], x[N];\n\n\nvoid mul(int a[M],int b[M],int c[M]) {\n\tint i,j,k;\n\tc[0]=(ll)a[0]*b[0]%mod;\n\tfor(i=1;i<=n;i++) c[0]=(c[0]+(((ll)a[i]*b[i])%mod)*(1<<(n-i)))%mod;\n\tfor(k=1;k<=n;k++) {\n\t\tc[k]=(ll)a[0]*b[k]%mod;\n\t\tfor(i=1;i<k;i++) c[k]=(c[k]+(((ll)a[i]*b[i])%mod)*(1<<(n-i)))%mod;\n\t\tfor(i=k+1;i<=n;i++) c[k]=(c[k]+(((ll)a[i]*b[k])%mod)*(1<<(n-i)))%mod;\n\t\tfor(i=k+1;i<=n;i++) c[k]=(c[k]+(((ll)a[k]*b[i])%mod)*(1<<(n-i)))%mod;\n\t\tc[k]=(c[k]+(ll)a[k]*b[0])%mod;\n\t}\n}\n\nvoid mypow(ll p) {\n\tif(p==1) return;\n\tint d[M];\n\tmemcpy(d,a,sizeof(a));\n\tmypow(p/2);\n\tmul(a,a,b);\n\tif(p&1) {\n\t\tmemcpy(c,b,sizeof(b));\n\t\tmul(d,c,b);\n\t}\n\tmemcpy(a,b,sizeof(b));\n}\n\nint main(){\n\t//freopen(\"E2.in\", \"r\", stdin);\n\tint i,j,k;\n\tscanf(\"%d %I64d %d\",&n,&t,&m);\n\tfor(i=0;i<m;i++) scanf(\"%d\",&x[i]);\n\tfor(i=m;i<(1<<n);i++) x[i]=(x[i-m]*101+10007)%mod;\n\ta[0]=1;\n\tfor(i=1;i<=n;i++) a[i]=(1<<(i-1))%mod;\n\tmypow(t);\n\n\tint ans=0;\n\tint nn=n*4/5+1;\n\n\tfor(i=0; i<(1<<n); i++)f[i]=x[i];\n\tfor(i=n-1; i>=0; i--){\n\t\tint u=1<<i;\n\t\tif(i<nn){\n\t\t\tfor(k=0; k<(1<<nn); k++){\n\t\t\t\ty[k] = (y[k]+(ll)a[i+1]*f[u])%mod;\n\t\t\t\tu--;\n\t\t\t\tif(u==-1)u=(1<<(i+1))-1;\n\t\t\t}\n\t\t}\n\t\tfor(k=0; k<(1<<i); k++){\n\t\t\tf[k]=(f[k]+f[k+(1<<i)]);\n\t\t\tif(f[k]>=mod)f[k]-=mod;\n\t\t}\n\t}\n\n\tfor(k=(1<<nn); k<(1<<n); k++){\n\t\ty[k]=y[k-(1<<nn)];\n\t}\n\tfor(i=0; i<(1<<n); i++)f[i]=x[i];\n\tfor(i=n-1; i>=nn; i--){\n\t\tint u=1<<i;\n\t\tfor(k=0; k<(1<<n); k++){\n\t\t\ty[k] = (y[k]+(ll)a[i+1]*f[u])%mod;\n\t\t\tu--;\n\t\t\tif(u==-1)u=(1<<(i+1))-1;\n\t\t}\n\t\tfor(k=0; k<(1<<i); k++){\n\t\t\tf[k]=(f[k]+f[k+(1<<i)]);\n\t\t\tif(f[k]>=mod)f[k]-=mod;\n\t\t}\n\t}\n\tfor(k=0; k<(1<<n); k++)y[k]=(y[k]+(ll)a[0]*x[((1<<n)-k)&((1<<n)-1)])%mod, ans^=y[k];\n\tprintf(\"%d\\n\", ans);\n\treturn 0;\n}\n"], "input": "", "output": "", "tags": ["math", "matrices"], "dificulty": "3100", "interactive": false}