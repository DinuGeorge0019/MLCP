{
    "link": "https://codeforces.com//contest/1034/problem/C",
    "problemId": "222952",
    "problem_idx": "C",
    "shortId": "1034C",
    "contest_number": "1034",
    "problem_submissions": {
        "E": [
            43279785,
            43212413,
            43229978,
            43294521,
            43208696,
            43220993,
            84865485,
            43443164,
            43443120,
            43443018,
            43216190
        ],
        "D": [
            43250433,
            43221298,
            43215071,
            43392001,
            47789625
        ],
        "B": [
            43205891,
            43195267,
            43193943,
            43195031,
            43196760,
            43197157,
            43191231,
            43195573,
            43213572,
            43195172,
            43208923,
            43193201,
            43202069,
            43195780,
            43197206,
            43192315,
            43197387,
            43207849,
            43201323,
            43198501
        ],
        "C": [
            43201825,
            43200815,
            43202708,
            43202190,
            43201916,
            43202773,
            43198929,
            43200220,
            43198793,
            43202127,
            43201792,
            43209061,
            43203518,
            43208155,
            43197731,
            43206185,
            43207426
        ],
        "A": [
            43186061,
            43219248,
            43187942,
            43187082,
            43188745,
            43197770,
            43193324,
            43188028,
            43186801,
            43186422,
            43193256,
            43186588,
            43188667,
            43226991,
            43226928,
            43187156,
            43187973,
            43187877,
            43186866,
            43188894,
            43192595
        ]
    },
    "name": "C. Region Separation",
    "statement": "There are n cities in the Kingdom of Autumn, numbered from 1 to n.\r\nPeople can travel between any two cities using n-1 two-directional\r\nroads.This year, the government decides to separate the kingdom. There\r\nwill be regions of different levels. The whole kingdom will be the\r\nregion of level 1. Each region of i-th level should be separated into\r\nseveral (at least two) regions of i+1-th level, unless i-th level is the\r\nlast level. Each city should belong to exactly one region of each level\r\nand for any two cities in the same region, it should be possible to\r\ntravel between them passing the cities in the same region only.According\r\nto research, for each city i, there is a value a_i, which describes the\r\nimportance of this city. All regions of the same level should have an\r\nequal sum of city importances.Your task is to find how many plans there\r\nare to determine the separation of the regions that all the conditions\r\nare satisfied. Two plans are considered different if and only if their\r\nnumbers of levels are different or there exist two cities in the same\r\nregion of one level in one plan but in different regions of this level\r\nin the other plan. Since the answer may be very large, output it modulo\r\n10^9+7.\r\n",
    "solutions": [
        "#include<cstdio>\nconst int mod=1000000007,hmod=10000019;\nint n,a[1000010],p[1000010],f[1000010];\nlong long sz[1000010];\nint g[1000010];\nlong long gcd(long long a,long long b){return b?gcd(b,a%b):a;}\nint main(){\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++)scanf(\"%d\",a+i),sz[i]=a[i];\n\tfor(int i=2;i<=n;i++)scanf(\"%d\",p+i);\n\tfor(int i=n;i>1;i--)sz[p[i]]+=sz[i];\n\tfor(int i=1;i<=n;i++){\n\t\tlong long j=sz[1]/gcd(sz[1],sz[i]);\n\t\tif(j<=n)g[j]++;\n\t}\n\tfor(int i=n;i;i--)\n\t\tfor(int j=i*2;j<=n;j+=i)g[j]+=g[i];\n\tfor(int i=n;i>=1;i--)if(g[i]>=i){\n\t\tf[i]=1;\n\t\tfor(int j=i*2;j<=n;j+=i)(f[i]+=f[j])%=mod;\n\t}\n\tprintf(\"%d\\n\",f[1]);\n}\n"
    ],
    "input": "",
    "output": "",
    "tags": [
        "combinatorics",
        "dp",
        "number theory",
        "trees"
    ],
    "dificulty": "2700",
    "interactive": false,
    "file_name": "D:\\scoala\\RESEARCH\\MLCP\\01_CODEFORCES_DATASET\\DIV1\\C. Region Separation.json",
    "editorial_link": "https://codeforces.com//blog/entry/61993",
    "editorial": "Solution First, we try to find whether itâs possible to separate the\nkingdom into regions of level- with the same sum of values. We calculate\n, the sum of all the values, so each region should have sum . Let be the\nsum of values in the subtree of root . We consider all the cities from\nthe leaves to the root, when a subtree has sum , separating it from the\ntree. We find that only the with will be considered. So there should be\nat least cities satisfying this condition. And if there exist such\ncities, we cut the edge to their father (if it is not the root), so the\nsize of each connected part will be multiple of . Since all the values\nare positive, all the connected parts have size . So we just need to\ncount how many cities with there are. Let the equation be , where is a\npositive integer, so should be a multiple of . Now we can use a simple\ndp with time to find whether itâs possible to separate the kingdom into\nregions of level- for all the .And itâs not difficult to find that there\ncan be regions of level- if and only if there can be regions of level-\nand is a factor of . Let be the number of plans with regions of the last\nlevel, and we enumerate the factors of to transform. So the total time\nof this solution is (including the time to calculate the gcd).\n",
    "hint": []
}