{"link": "https://codeforces.com//contest/441/problem/E", "problemId": "10180", "problem_idx": "E", "shortId": "441E", "contest_number": "441", "problem_submissions": {"D": [6846993, 6848184, 6846636, 6846799, 6846427, 6846976, 6846637, 6847967, 6844170, 6847911, 6848088, 6847662, 6847887, 6842471, 6843010], "C": [6842791, 6840708, 6842295, 6841947, 6842979, 6843258, 6842150, 6845333, 6842762, 6847076, 6842331, 6843795, 6844814, 6843899, 6843750, 6845351, 6843645, 6850933, 6849893], "B": [6840560, 6839393, 6840429, 6840462, 6840569, 6841161, 6840630, 6842225, 6840707, 6845954, 6840866, 6842539, 6843417, 6847639, 6842752, 6841004, 6841839], "A": [6839071, 6838557, 6838730, 6838755, 6839171, 6839289, 6839675, 6840019, 6839272, 6839363, 6838491, 6838790, 6838791, 6839587, 6842218, 6839738, 6839077, 6839417], "E": [6847038, 6850560]}, "name": "E. Valera and Number", "statement": "Valera is a coder. Recently he wrote a funny program. The pseudo code\r\nfor this program is given below://input: integers x, k, pa = x;for(step\r\n= 1; step <= k; step = step + 1){ rnd = [random integer from 1 to 100];\r\nif(rnd <= p) a = a * 2; else a = a + 1;}s = 0;while(remainder after\r\ndividing a by 2 equals 0){ a = a / 2; s = s + 1;}Now Valera wonders:\r\ngiven the values , and , what is the expected value of the resulting\r\nnumber ?\r\n", "solutions": ["#include <cstdio>\n\nint count(int x) {\n    if (x == 0)\n        return 0;\n    int ret = 0;\n    for (; x % 2 == 0; x /= 2)\n        ++ ret;\n    return ret;\n}\n\nint get(int x) {\n    int ret = count(x);\n    if (ret > 0)\n        return 50 + ret;\n    else\n        return 51 - count(x + 1);\n}\n\ndouble dp[201][300][256];\n\nint add(int x) {\n    if (x > 50)\n        return 50;\n    else {\n        x = 51 - x;\n        return x + 50;\n    }\n}\n\nint mul(int x, int y) {\n    y /= 128;\n    if (y == 0) {\n        if (x <= 50)\n            return 51;\n        else\n            return x + 1;\n    } else {\n        if (x <= 50)\n            return x - 1;\n        else\n            return 50;\n    }\n}\n\nint main() {\n    int x, k, p;\n    scanf(\"%d%d%d\", &x, &k, &p);\n    if (x < 256)\n        x += 1 << 20;\n    dp[0][get(x / 256)][x % 256] = 1;\n    for (int i = 0; i < k; ++ i)\n        for (int j = 0; j < 300; ++ j) {\n            for (int l = 0; l < 256; ++ l)\n                if (dp[i][j][l] > 0) {\n                    if (l >= 128)\n                        dp[i + 1][mul(j, l)][l * 2 - 256] += p / 100.0 * dp[i][j][l];\n                    else\n                        dp[i + 1][mul(j, l)][l * 2] += p / 100.0 * dp[i][j][l];\n                    if (l == 255)\n                        dp[i + 1][add(j)][0] += (100 - p) / 100.0 * dp[i][j][l];\n                    else\n                        dp[i + 1][j][l + 1] += (100 - p) / 100.0 * dp[i][j][l];\n                }\n        }\n    double ans = 0;\n    for (int j = 0; j <= 50; ++ j)\n        ans += dp[k][j][0] * 8;\n    for (int j = 51; j < 300; ++ j)\n        ans += dp[k][j][0] * (8 + j - 50);\n    for (int i = 1; i < 256; ++ i) {\n        int cnt = count(i);\n        for (int j = 0; j < 300; ++ j)\n            ans += dp[k][j][i] * cnt;\n    }\n    printf(\"%.12f\\n\", ans);\n    return 0;\n}\n"], "input": "", "output": "", "tags": ["bitmasks", "dp", "math", "probabilities"], "dificulty": "2400", "interactive": false}