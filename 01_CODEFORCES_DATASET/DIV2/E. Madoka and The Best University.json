{"link": "https://codeforces.com//contest/1717/problem/E", "problemId": "1527573", "problem_idx": "E", "shortId": "1717E", "contest_number": "1717", "problem_submissions": {"F": [170628195, 170631297, 170636621, 170638786, 170642998, 170642114, 170636113, 170640846, 170643077, 170643996, 170641292, 170639769, 170690219, 170646621, 170646461, 170679476, 170679133, 170639635], "E": [170609804, 170616589, 170615870, 170622633, 170610853, 170628228, 170623924, 170617172, 170622667, 170627714, 170627468, 170624918, 170630751, 170634625, 170598060, 170611863, 170622101, 170626877, 170623213, 170615426], "D": [170607171, 170605005, 170609922, 170610949, 170622497, 170609050, 170615733, 170627107, 170617123, 170612935, 170623602, 170628949, 170618958, 170628847, 170611626, 170607221, 170605022, 170607463, 170648316, 170620005], "C": [170601766, 170595872, 170600515, 170604005, 170603370, 170603689, 170597455, 170603675, 170604089, 170603783, 170612791, 170614880, 170609148, 170602273, 170598587, 170598491, 170604850, 170597420], "B": [170595706, 170594734, 170596230, 170601030, 170598846, 170599230, 170600372, 170596828, 170597841, 170615090, 170608022, 170603542, 170597876, 170599659, 170595411, 170595780, 170599224, 170595920], "A": [170594341, 170594250, 170594713, 170598166, 170594912, 170595202, 170594533, 170594589, 170594840, 170594292, 170596316, 170595526, 170594805, 170598577, 170594243, 170594388, 170596942, 170594653]}, "name": "E. Madoka and The Best University", "statement": "Madoka wants to enter to \"\", but in the entrance exam she came across a\r\nvery difficult task:Given an integer n, it is required to calculate\r\nsum{\r\noperatorname{lcm}(c,\r\ngcd(a, b))}, for all triples of positive integers (a, b, c), where a +\r\nb + c = n.In this problem\r\ngcd(x, y) denotes the greatest common divisor of x and y, and\r\noperatorname{lcm}(x, y) denotes the least common multiple of x and\r\ny.Solve this problem for Madoka and help her to enter to the best\r\nuniversity!\r\n", "solutions": ["#include <bits/stdc++.h>\nusing namespace std;\nusing i64 = long long;\nconst int P = 1e9 + 7;\ntemplate<class T>\ninline T power(T a, i64 b) {\n\tT res = 1;\n\tfor (; b; b >>= 1, a *= a)\n\t\tif (b & 1) res *= a;\n\treturn res;\n}\ninline int norm(int x) {\n\tif (x < 0) x += P;\n\tif (x >= P) x -= P;\n\treturn x;\n}\nstruct Z {\n\tint x;\n\tZ(int _x = 0) : x(norm(_x)) {}\n\tinline Z operator-() const {\n\t\tif (!x) return 0;\n\t\treturn Z(P - x);\n\t}\n\tinline Z &operator+=(const Z &rhs) {\n\t\tx += rhs.x;\n\t\tif (x >= P) x -= P;\n\t\treturn *this;\n\t}\n\tinline Z &operator-=(const Z &rhs) {\n\t\tx -= rhs.x;\n\t\tif (x < 0) x += P;\n\t\treturn *this;\n\t}\n\tinline Z &operator*=(const Z &rhs) {\n\t\tx = 1ull * x * rhs.x % P;\n\t\treturn *this;\n\t}\n\tinline Z inv() const {\n\t\treturn power(*this, P - 2);\n\t}\n\tinline Z &operator/=(const Z &rhs) {\n\t\t*this *= rhs.inv();\n\t\treturn *this;\n\t}\n\tinline friend Z operator+(const Z &lhs, const Z &rhs) {\n\t\tZ res = lhs;\n\t\treturn res += rhs, res;\n\t}\n\tinline friend Z operator-(const Z &lhs, const Z &rhs) {\n\t\tZ res = lhs;\n\t\treturn res -= rhs, res;\n\t}\n\tinline friend Z operator*(const Z &lhs, const Z &rhs) {\n\t\tZ res = lhs;\n\t\treturn res *= rhs, res;\n\t}\n\tinline friend Z operator/(const Z &lhs, const Z &rhs) {\n\t\tZ res = lhs;\n\t\treturn res /= rhs, res;\n\t}\n};\nconst int N = 100005;\nvector<int> divisors[N];\nint phi[N];\nint main() {\n\tfor (int i = 1; i < N; ++i) {\n\t\tfor (int j = i; j < N; j += i) {\n\t\t\tdivisors[j].push_back(i);\n\t\t}\n\t}\n\tiota(phi, phi + N, 0);\n\tphi[1] = 0;\n\tfor (int i = 2; i < N; ++i) {\n\t\tif ((int) divisors[i].size() == 2) {\n\t\t\tfor (int j = i; j < N; j += i) {\n\t\t\t\tphi[j] /= i;\n\t\t\t\tphi[j] *= i - 1;\n\t\t\t}\n\t\t}\n\t}\n\tint n;\n\tcin >> n;\n\tZ ans = 0;\n\tfor (int c = 1; c <= n; ++c) {\n\t\tint d = n - c;\n\t\tfor (auto g : divisors[d]) {\n\t\t\tZ cur = 1ll * c * g / __gcd(c, g) % P;\n\t\t\tZ coef = phi[d / g];\n\t\t\tans += cur * coef;\n\t\t}\n\t}\n\tcout << ans.x << \"\\n\";\n    return 0;\n}"], "input": "", "output": "", "tags": ["math", "number theory"], "dificulty": "2200", "interactive": false}