{"link": "https://codeforces.com//contest/1153/problem/F", "problemId": "329971", "problem_idx": "F", "shortId": "1153F", "contest_number": "1153", "problem_submissions": {"F": [52702167, 52706102, 52706128, 52712612, 52712916, 52713472, 52705273, 53020024], "B": [52696113, 52686055, 52686525, 52695492, 52689812, 52686724, 52686280, 52688127, 52685475, 52701491, 52686741, 52698339, 52691737, 52687040, 52687523, 52688787, 52686777, 52686537, 52688504], "E": [52693078, 52699456, 52700287, 52698093, 52707544, 52707213, 52699436, 52799036, 52699341, 52698614, 52704976, 52690529, 52703713, 52700978, 52703569, 52699263, 52702855, 52704578], "C": [52688281, 52690605, 52689780, 52702384, 52693171, 52696923, 52689825, 52696486, 52688289, 52687066, 52689512, 52696924, 52687069, 52688673, 52691802, 52692527, 52691364, 52690866, 52691574], "D": [52686405, 52692724, 52692621, 52691138, 52695645, 52702315, 52692971, 52694653, 52693169, 52691270, 52695539, 52695198, 52699214, 52692631, 52695518, 52703264, 52696334, 52697661, 52695431], "A": [52684329, 52684726, 52684448, 52687427, 52684995, 52684651, 52684577, 52684221, 52684289, 52684251, 52684828, 52699079, 52689885, 52684309, 52684805, 52684271, 52684301, 52684354, 52684338]}, "name": "F. Serval and Bonus Problem", "statement": "Getting closer and closer to a mathematician, Serval becomes a\r\nuniversity student on math major in Japari University. On the Calculus\r\nclass, his teacher taught him how to calculate the expected length of a\r\nrandom subsegment of a given segment. Then he left a bonus problem as\r\nhomework, with the award of a garage kit from IOI. The bonus is to\r\nextend this problem to the general case as follows.You are given a\r\nsegment with length l. We randomly choose n segments by choosing two\r\npoints (maybe with non-integer coordinates) from the given segment\r\nequiprobably and the interval between the two points forms a segment.\r\nYou are given the number of random segments n, and another integer k.\r\nThe 2n endpoints of the chosen segments split the segment into (2n+1)\r\nintervals. Your task is to calculate the expected total length of those\r\nintervals that are covered by at least k segments of the n random\r\nsegments.You should find the answer modulo 998244353.\r\n", "solutions": ["//ihdignite\n\n#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\n\nconst int MAXN = 2e3;\nconst int MOD = 998244353;\n\nint n, k, l;\n\nll inverse[2*MAXN+2], factorial[2*MAXN+2], inversefactorial[2*MAXN+2], power2[2*MAXN+2], dp[MAXN+1];\n\nint main() {\n\tios_base::sync_with_stdio(0);\n\tcin.tie(NULL);\n\n\tcin >> n >> k >> l;\n\t\n\tinverse[1]=1;\n\tfor(int i=2; i<2*MAXN+2; ++i)\n\t\tinverse[i]=MOD-MOD/i*inverse[MOD%i]%MOD;\n\n\tfactorial[0]=inversefactorial[0]=power2[0]=1;\n\tfor(int i=1; i<2*MAXN+2; ++i) {\n\t\tfactorial[i]=factorial[i-1]*i%MOD;\n\t\tinversefactorial[i]=inversefactorial[i-1]*inverse[i]%MOD;\n\t\tpower2[i]=power2[i-1]*2%MOD;\n\t}\n\n\tfor(int i=n; i>=k; --i) {\n\t\tdp[i] = factorial[i]*factorial[i]%MOD*power2[i]%MOD*inversefactorial[2*i+1]%MOD;\n\t\tdp[i] = dp[i]*factorial[n]%MOD*inversefactorial[i]%MOD*inversefactorial[n-i]%MOD;\n\t\tfor(int j=i+1; j<=n; ++j) {\n\t\t\tdp[i] = (dp[i]-factorial[j]*inversefactorial[i]%MOD*inversefactorial[j-i]%MOD*dp[j]%MOD+MOD)%MOD;\n\t\t}\n\t}\n\n\tll ans=0;\n\tfor(int i=k; i<=n; ++i)\n\t\tans=(ans+dp[i])%MOD;\n\tcout << ans*l%MOD << endl;\n\n\treturn 0;\n}\n"], "input": "", "output": "", "tags": ["combinatorics", "dp", "math", "probabilities"], "dificulty": "2600", "interactive": false}