{"link": "https://codeforces.com//contest/1818/problem/E", "problemId": "1897387", "problem_idx": "E", "shortId": "1818E", "contest_number": "1818", "problem_submissions": {"F": [203954465, 203930910, 203989728, 203950170], "E": [203940713, 203952207, 203954969, 203955944, 204078536, 203944339, 203943920, 203965332, 203957684, 203924512], "D": [203935580, 203930131, 203939536, 203937747, 203926993, 203932798, 203948151, 203919017, 203933133, 203930283, 203939418, 203978791, 203937294, 203949049, 203940699, 203938945, 203937604, 203937271], "C": [203927589, 203919798, 203928628, 203925534, 203931513, 203921512, 203927085, 203928001, 203926317, 203916672, 203923862, 203933925, 203926373, 203934292, 203922244, 203928248, 203928037, 203928918], "B": [203922412, 203918213, 203919638, 203920216, 203917691, 203917420, 203954835, 203921335, 203916143, 203918490, 203937550, 203919150, 203922597, 203918604, 203921444, 203917928, 203921361, 203920046, 203919333], "A": [203919670, 203917474, 203915999, 203915969, 203915149, 203915496, 203915115, 203915794, 203934868, 203916606, 203917417, 203915457, 203960905, 203915626, 203915203, 203915634, 203917495]}, "name": "E. Similar Polynomials", "statement": "A polynomial A(x) of degree d is an expression of the form A(x) = a_0 +\r\na_1 x + a_2 x^2 +\r\ndots + a_d x^d, where a_i are integers, and a_d\r\nneq 0. Two polynomials A(x) and B(x) are called similar if there is an\r\ninteger s such that for any integer x it holds that B(x)\r\nequiv A(x+s)\r\npmod{10^9+7}. For two similar polynomials A(x) and B(x) of degree d,\r\nyou\u2019re given their values in the points x=0,1,\r\ndots, d modulo 10^9+7.Find a value s such that B(x)\r\nequiv A(x+s)\r\npmod{10^9+7} for all integers x.\r\n", "solutions": ["#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long LL;\nconst int MX = 2500005;\nconst int M = 1000000007;\nconst int mod = M;\nLL inv[MX], f[MX], g[MX];\nvoid init() {\n  int i;\n  inv[1] = 1;\n  for (i = 2; i < MX; i++) inv[i] = inv[M % i] * (M - M / i) % M;\n  f[0] = g[0] = 1;\n  for (i = 1; i < MX; i++) {\n    f[i] = f[i - 1] * i % M;\n    g[i] = g[i - 1] * inv[i] % M;\n  }\n}\nLL ext_gcd(LL a, LL b, LL& x, LL& y) {\n  LL g;\n  if (b) {\n    g = ext_gcd(b, a % b, y, x);\n    y -= a / b * x;\n  }\n  else {\n    g = a;\n    x = 1, y = 0;\n  }\n  return g;\n}\nLL C[MX];\nLL A[MX], B[MX];\nint main() {\n\t#ifndef ONLINE_JUDGE\n\tfreopen(\"in.txt\", \"r\", stdin);\n\t#endif\n\tios::sync_with_stdio(0);\n\tcin.tie(0);\n\tLL d;\n\tcin >> d;\n\tinit();\n\tfor (int i = 0; i <= d; i ++) cin >> A[i];\n\tfor (int i = 0; i <= d; i ++) cin >> B[i];\n\tfor (int i = 0; i <= d; i ++) {\n\t\tC[i] = (g[d - i] * g[i]) % M;\n\t\tif (i % 2) C[i] = (M - C[i]) % M;\n\t}\n\tLL t1, t2, t3;\n\tt1 = t2 = 0;\n\tfor (int i = 0; i <= d; i ++) {\n\t\tt1 = (t1 + (A[i] * ((C[i] * d) % mod)) % mod) % mod;\n\t\tt3 = (((d + 1) * d / 2) % mod + mod - i) % mod;\n//\t\tcerr << t3 << endl;\n\t\tt2 = (t2 + (((B[i] - A[i] + mod) * t3 % mod) * C[i] % mod)) % mod;\n\t}\n\tLL x1, x2;\n\text_gcd(t1, mod, x1, x2);\n\tx1 = (x1 % mod + mod) % mod;\n\tcout << (mod - (t2 * x1) % mod) % mod << endl;\n\treturn 0;\n}\n\n\n"], "input": "", "output": "", "tags": ["math"], "dificulty": "2400", "interactive": false}