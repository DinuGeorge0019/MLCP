{"link": "https://codeforces.com//contest/1181/problem/C", "problemId": "359262", "problem_idx": "C", "shortId": "1181C", "contest_number": "1181", "problem_submissions": {"E2": [55650122, 55830557, 55704213], "E1": [55633819, 55638516, 55638501, 55637414, 55641214, 55640980, 55643225, 55640108, 55640609, 55642576, 55643544, 55642412, 55643807, 55641985, 55642964, 240099989], "D": [55631090, 55633784, 55633448, 55631287, 55633631, 55633273, 55636890, 55634366, 55634832, 55638016, 55638738, 55634315, 55639336, 55636804, 55635357, 55637569, 55636303, 55635471, 55634737, 55630910], "B": [55627797, 55620636, 55623454, 55633957, 55622559, 55626217, 109938468, 109937680, 55629226, 55627039, 55625976, 55641971, 55622249, 55622014, 55624276, 55623137], "C": [55625127, 55629408, 55627484, 55625656, 55629031, 55630033, 55628446, 55636714, 55636852, 55632570, 55634750, 55628993, 55633600, 55628788, 55626023, 55632494, 55631294, 55629796, 55629116, 55636617], "A": [55616968, 55616973, 55617720, 55617671, 55617776, 55617314, 55618111, 109966538, 109938562, 109938324, 55618923, 55617442, 55639586, 55635703, 55628269, 55617672, 55630717, 55619287, 55617106, 55617973, 55617169, 55617325]}, "name": "C. Flag", "statement": "Innokenty works at a flea market and sells some rare items. Recently he\r\nfound an old rectangular blanket. It turned out that the blanket is\r\nsplit in n\r\ncdot m colored pieces that form a rectangle with n rows and m columns.\r\nThe colored pieces attracted Innokenty\u2019s attention so he immediately\r\ncame up with the following business plan. If he cuts out a subrectangle\r\nconsisting of three colored stripes, he can sell it as a flag of some\r\ncountry. Innokenty decided that a subrectangle is similar enough to a\r\nflag of some country if it consists of three stripes of heights placed\r\none above another, where each stripe consists of cells of equal color.\r\nOf course, the color of the top stripe must be different from the color\r\nof the middle stripe; and the color of the middle stripe must be\r\ndifferent from the color of the bottom stripe.Innokenty has not yet\r\ndecided what part he will cut out, but he is sure that the flag\u2019s\r\nboundaries should go along grid lines. Also, Innokenty won\u2019t rotate the\r\nblanket. Please help Innokenty and count the number of different\r\nsubrectangles Innokenty can cut out and sell as a flag. Two\r\nsubrectangles located in different places but forming the same flag are\r\nstill considered different.\r\n", "solutions": ["#include <bits/stdc++.h>\nusing namespace std;\n\n#define ll long long\n#define ar array\n\nconst int mxN=1e3;\nint n, m, nxt[mxN][mxN];\nstring g[mxN];\n\nstruct fd {\n\tint l;\n\tchar c[3];\n\tbool operator==(const fd &o) const {\n\t\treturn l==o.l&&c[0]==o.c[0]&&c[1]==o.c[1]&&c[2]==o.c[2];\n\t}\n} ff[mxN];\n\nint main() {\n\tios::sync_with_stdio(0);\n\tcin.tie(0);\n\n\tcin >> n >> m;\n\tfor(int i=0; i<n; ++i)\n\t\tcin >> g[i];\n\tfor(int j=0; j<m; ++j)\n\t\tnxt[n-1][j]=n;\n\tfor(int i=n-2; ~i; --i)\n\t\tfor(int j=0; j<m; ++j)\n\t\t\tnxt[i][j]=g[i][j]==g[i+1][j]?nxt[i+1][j]:i+1;\n\tint ans=0;\n\tfor(int i=0; i<n; ++i) {\n\t\tfor(int j=0; j<m; ++j) {\n\t\t\tint i2=nxt[i][j], i3=i2<n?nxt[i2][j]:n, i4=i3<n?nxt[i3][j]:n;\n\t\t\tff[j].l=nxt[i][j]-i;\n\t\t\tif(i3-i2!=ff[j].l||i4-i3<ff[j].l)\n\t\t\t\tff[j].l=-1;\n\t\t\tff[j].c[0]=g[i][j];\n\t\t\tif(i2<n)\n\t\t\t\tff[j].c[1]=g[i2][j];\n\t\t\tif(i3<n)\n\t\t\t\tff[j].c[2]=g[i3][j];\n\t\t}\n\t\tfor(int j=0, k=0; j<m; j=k) {\n\t\t\tfor(; k<m&&ff[k]==ff[j]; ++k);\n\t\t\tif(~ff[j].l)\n\t\t\t\tans+=(k-j)*(k-j+1)/2;\n\t\t}\n\t}\n\tcout << ans;\n}"], "input": "", "output": "", "tags": ["brute force", "combinatorics", "dp", "implementation"], "dificulty": "1900", "interactive": false}