{"link": "https://codeforces.com//contest/1174/problem/E", "problemId": "353394", "problem_idx": "E", "shortId": "1174E", "contest_number": "1174", "problem_submissions": {"E": [55039336, 55044361, 55047429, 55040838, 55047094, 55042040, 55042878, 55038492, 55074361, 55045215, 55070465, 55052562, 55043353, 55077730, 55041823, 55062278, 55053681], "D": [55035444, 55029768, 55027239, 55028917, 55030017, 55031266, 55030524, 55028205, 55035219, 55028511, 55029682, 55031022, 55031315, 55027972, 55032439, 55032979, 55028299, 55033103, 55028679, 55031061], "F": [55031300, 55038342, 55040097, 55045770, 55039431, 55046891, 55053088, 55047685, 55049921, 55049066, 55039349, 55055925, 55055858, 55055759, 55055564, 55043749, 55038284, 55041004, 55058775, 55042228, 55041603, 55041698, 55114618, 55041755, 55042241], "C": [55029741, 55022001, 55024172, 55023941, 55024511, 55027105, 55028150, 55023124, 55027027, 55025166, 55024084, 55029153, 55025965, 55022505, 55024454, 55026547, 55024657, 55028838, 55026161, 55026567], "A": [55027419, 55020850, 55019913, 55020331, 55020481, 55020928, 55020714, 55019727, 55021559, 55020242, 55019597, 55021256, 55019953, 55019896, 55019608, 55020117, 55020693, 55023232, 55019790, 55019854], "B": [55024841, 55019799, 55022270, 55021874, 55022067, 55023546, 55022681, 55021183, 55024705, 55023720, 55021538, 55025471, 55021813, 55021948, 55022335, 55022891, 55031469, 55023328, 55023867, 55022256]}, "name": "E. Ehab and the Expected GCD Problem", "statement": "Let\u2019s define a function f(p) on a permutation p as follows. Let g_i be\r\nthe greatest common divisor (GCD) of elements p_1, p_2, ..., p_i (in\r\nother words, it is the GCD of the prefix of length i). Then f(p) is the\r\nnumber of elements among g_1, g_2, ..., g_n.Let f_{max}(n) be the\r\nmaximum value of f(p) among all permutations p of integers 1, 2, ...,\r\nn.Given an integers n, count the number of permutations p of integers 1,\r\n2, ..., n, such that f(p) is equal to f_{max}(n). Since the answer may\r\nbe large, print the remainder of its division by 1000\r\n,000\r\n,007 = 10^9 + 7.\r\n", "solutions": ["#include <bits/stdc++.h>\nusing namespace std;\nconst int N = 2e6 + 5;\ntypedef long long ll;\nconst int mod = 1e9 + 7;\nint add(int a, int b)\n{\n\ta += b;\n\treturn a >= mod ? a - mod : a;\n}\nint sub(int a, int b)\n{\n\ta -= b;\n\treturn a < 0 ? a + mod : a;\n}\nint mul(int a, int b) { return (ll)a * b % mod; }\nint qpow(int a, int b)\n{\n\tint ret = 1;\n\tfor (; b; b >>= 1, a = mul(a, a))\n\t\tif (b & 1)\n\t\t\tret = mul(ret, a);\n\treturn ret;\n}\n/* math */\nint fac[N], ifac[N];\ninline void init(int n)\n{\n\tifac[0] = fac[0] = 1;\n\tfor (int i = 1; i <= n; i++)\n\t\tfac[i] = mul(fac[i - 1], i);\n\tifac[n] = qpow(fac[n], mod - 2);\n\tfor (int i = n - 1; i; i--)\n\t\tifac[i] = mul(ifac[i + 1], i + 1);\n}\n\ninline int binom(int a, int b)\n{\n\tif (b > a)\n\t\treturn 0;\n\treturn mul(fac[a], mul(ifac[b], ifac[a - b]));\n}\n\nint f[N], g[N];\nint n;\n\nint main()\n{\n\tinit(2e6);\n\tcin >> n;\n\tfor (int i = n; i; i--)\n\t{\n\t\tif (i * 2 > n)\n\t\t{\n\t\t\tf[i] = g[i] = 1;\n\t\t}\n\t\tfor (int j = 2; j * i <= n; j++)\n\t\t{\n\t\t\tif (f[i * j] + 1 > f[i])\n\t\t\t\tf[i] = f[i * j] + 1, g[i] = 0;\n\t\t\tif (f[i * j] + 1 == f[i])\n\t\t\t{\n\t\t\t\tint t1 = n / (i * j), t2 = n / (i);\n\t\t\t\tg[i] = add(g[i], mul(g[i * j], mul(fac[t2 - t1], binom(n - t1 - 1, t2 - t1 - 1))));\n\t\t\t}\n\t\t}\n\t}\n\tcout << g[1] << endl;\n}"], "input": "", "output": "", "tags": ["combinatorics", "dp", "math", "number theory"], "dificulty": "2500", "interactive": false}