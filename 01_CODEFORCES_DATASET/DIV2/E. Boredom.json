{"link": "https://codeforces.com//contest/854/problem/E", "problemId": "121097", "problem_idx": "E", "shortId": "854E", "contest_number": "854", "problem_submissions": {"E": [30148890, 30158025, 30153207, 30152099, 30153347, 30153605, 30153960, 30156519, 30155338, 30152255, 30155374, 30156465, 30154492, 30155027, 30148559, 30154341, 30150107, 30159302, 30147585, 30149154], "D": [30145685, 30142579, 30146315, 30147771, 30145357, 30143469, 30147555, 30149225, 30160358, 30148581, 30148332, 30147340, 30151054, 30154650, 30153132, 30141029, 30169028, 30157758, 30157493, 30145363, 30157424, 30143188], "C": [30138936, 30136736, 30141613, 30138597, 30141883, 30137426, 30140011, 30142683, 30144635, 30142411, 30142409, 30142369, 30142517, 30150426, 30151674, 30137870, 30138345, 30140659, 30136856, 30172754, 30148019], "B": [30137227, 30133256, 30139063, 30133886, 30139922, 30134279, 30135422, 30135809, 30140613, 30136252, 30139573, 30137665, 30140693, 30154807, 30155358, 30135403, 30136178, 30140207, 30133289, 30134600], "A": [30136803, 30131896, 30136932, 30132115, 30139440, 30132166, 30132064, 30131930, 30132413, 30132484, 30133433, 30131987, 30139438, 30153559, 30131806, 30133316, 30132007, 30137844, 30131966, 30135700]}, "name": "E. Boredom", "statement": "Ilya is sitting in a waiting area of Metropolis airport and is bored of\r\nlooking at time table that shows again and again that his plane is\r\ndelayed. So he took out a sheet of paper and decided to solve some\r\nproblems.First Ilya has drawn a grid of size and marked squares on it,\r\nsuch that no two marked squares share the same row or the same column.\r\nHe calls a rectangle on a grid with sides parallel to grid sides if\r\nexactly two of its corner squares are marked. There are exactly\r\nbeautiful rectangles.Ilya has chosen query rectangles on a grid with\r\nsides parallel to grid sides (not necessarily beautiful ones), and for\r\neach of those rectangles he wants to find its . Beauty degree of a\r\nrectangle is the number of beautiful rectangles that share at least one\r\nsquare with the given one.Now Ilya thinks that he might not have enough\r\ntime to solve the problem till the departure of his flight. You are\r\ngiven the description of marked cells and the query rectangles, help\r\nIlya find the beauty degree of each of the query rectangles.\r\n", "solutions": ["#include<bits/stdc++.h>\n\ntypedef unsigned int uint;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef double lf;\ntypedef long double llf;\ntypedef std::pair<int,int> pii;\n\n#define xx first\n#define yy second\n\ntemplate<typename T> inline T max(T a,T b){return a>b?a:b;}\ntemplate<typename T> inline T min(T a,T b){return a<b?a:b;}\ntemplate<typename T> inline T abs(T a){return a>0?a:-a;}\ntemplate<typename T> inline bool repr(T &a,T b){return a<b?a=b,1:0;}\ntemplate<typename T> inline bool repl(T &a,T b){return a>b?a=b,1:0;}\ntemplate<typename T> inline T gcd(T a,T b){T t;if(a<b){while(a){t=a;a=b%a;b=t;}return b;}else{while(b){t=b;b=a%b;a=t;}return a;}}\ntemplate<typename T> inline T sqr(T x){return x*x;}\n#define mp(a,b) std::make_pair(a,b)\n#define pb push_back\n#define I inline\n#define mset(a,b) memset(a,b,sizeof(a))\n#define mcpy(a,b) memcpy(a,b,sizeof(a))\n\n#define fo0(i,n) for(int i=0,i##end=n;i<i##end;i++)\n#define fo1(i,n) for(int i=1,i##end=n;i<=i##end;i++)\n#define fo(i,a,b) for(int i=a,i##end=b;i<=i##end;i++)\n#define fd0(i,n) for(int i=(n)-1;~i;i--)\n#define fd1(i,n) for(int i=n;i;i--)\n#define fd(i,a,b) for(int i=a,i##end=b;i>=i##end;i--)\n#define foe(i,x)for(__typeof(x.end())i=x.begin();i!=x.end();++i)\n\nstruct Cg{I char operator()(){return getchar();}};\nstruct Cp{I void operator()(char x){putchar(x);}};\n#define OP operator\n#define RT return *this;\n#define RX x=0;char t=P();while((t<'0'||t>'9')&&t!='-')t=P();bool f=0;\\\nif(t=='-')t=P(),f=1;x=t-'0';for(t=P();t>='0'&&t<='9';t=P())x=x*10+t-'0'\n#define RL if(t=='.'){lf u=0.1;for(t=P();t>='0'&&t<='9';t=P(),u*=0.1)x+=u*(t-'0');}if(f)x=-x\n#define RU x=0;char t=P();while(t<'0'||t>'9')t=P();x=t-'0';for(t=P();t>='0'&&t<='9';t=P())x=x*10+t-'0'\n#define TR *this,x;return x;\nI bool IS(char x){return x==10||x==13||x==' ';}template<typename T>struct Fr{T P;I Fr&OP,(int &x)\n{RX;if(f)x=-x;RT}I OP int(){int x;TR}I Fr&OP,(ll &x){RX;if(f)x=-x;RT}I OP ll(){ll x;TR}I Fr&OP,(char &x)\n{for(x=P();IS(x);x=P());RT}I OP char(){char x;TR}I Fr&OP,(char *x){char t=P();for(;IS(t);t=P());if(~t){for(;!IS\n(t)&&~t;t=P())*x++=t;}*x++=0;RT}I Fr&OP,(lf &x){RX;RL;RT}I OP lf(){lf x;TR}I Fr&OP,(llf &x){RX;RL;RT}I OP llf()\n{llf x;TR}I Fr&OP,(uint &x){RU;RT}I OP uint(){uint x;TR}I Fr&OP,(ull &x){RU;RT}I OP ull(){ull x;TR}};Fr<Cg>in;\n#define WI(S) if(x){if(x<0)P('-'),x=-x;char s[S],c=0;while(x)s[c++]=x%10+'0',x/=10;while(c--)P(s[c]);}else P('0')\n#define WL if(y){lf t=0.5;for(int i=y;i--;)t*=0.1;if(x>=0)x+=t;else x-=t,P('-');*this,(ll)(abs(x));P('.');if(x<0)\\\nx=-x;while(y--){x*=10;x-=floor(x*0.1)*10;P(((int)x)%10+'0');}}else if(x>=0)*this,(ll)(x+0.5);else *this,(ll)(x-0.5);\n#define WU(S) if(x){char s[S],c=0;while(x)s[c++]=x%10+'0',x/=10;while(c--)P(s[c]);}else P('0')\ntemplate<typename T>struct Fw{T P;I Fw&OP,(int x){WI(10);RT}I Fw&OP()(int x){WI(10);RT}I Fw&OP,(uint x){WU(10);RT}\nI Fw&OP()(uint x){WU(10);RT}I Fw&OP,(ll x){WI(19);RT}I Fw&OP()(ll x){WI(19);RT}I Fw&OP,(ull x){WU(20);RT}I Fw&OP()\n(ull x){WU(20);RT}I Fw&OP,(char x){P(x);RT}I Fw&OP()(char x){P(x);RT}I Fw&OP,(const char *x){while(*x)P(*x++);RT}\nI Fw&OP()(const char *x){while(*x)P(*x++);RT}I Fw&OP()(lf x,int y){WL;RT}I Fw&OP()(llf x,int y){WL;RT}};Fw<Cp>out;\n\nconst int N=200007;\n\nstruct query\n{\n\tint p,l,r,i,v;\n\tinline bool operator<(const query&t)const\n\t{\n\t\treturn p<t.p;\n\t}\n}q[N*4];\n\nint n,m,s[N],f[N],ta[N*4];\nll ans[N];\n\ninline int qry(int x)\n{\n\tint r=0;\n\tfor(;x;x^=x&-x)\n\t\tr+=f[x];\n\treturn r;\n}\n\nint main()\n{\n\t//freopen(\"in.txt\",\"r\",stdin);\n\tscanf(\"%d%d\",&n,&m);\n\tfor(int i=1;i<=n;i++)scanf(\"%d\",s+i);\n\tint qc=0;\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tint a,b,x,y;\n\t\tscanf(\"%d%d%d%d\",&a,&x,&b,&y);\n\t\tans[i]=(ll)n*(n-1)-(ll)(a-1)*(a-2)-(ll)(x-1)*(x-2)-(ll)(n-b)*(n-b-1)-(ll)(n-y)*(n-y-1);\n\t\t//printf(\"%lld\\n\",ans[i]);\n\t\tif(a!=1&&x!=1)q[qc++]=(query){a-1,1,x-1,i,1};\n\t\tif(a!=1&&y!=n)q[qc++]=(query){a-1,y+1,n,i+m,1};\n\t\tif(b!=n&&x!=1)q[qc++]=(query){b,1,x-1,i+m*2,-1},ta[i+m*2]=x-1;\n\t\tif(b!=n&&y!=n)q[qc++]=(query){b,y+1,n,i+m*3,-1},ta[i+m*3]=n-y;\n\t}\n\tstd::sort(q,q+qc);\n\tint lst=0;\n\tfor(int i=0;i<qc;i++)\n\t{\n\t\twhile(lst<q[i].p)\n\t\t{\n\t\t\tfor(int j=s[++lst];j<=n;j+=j&-j)\n\t\t\t\tf[j]++;\n\t\t}\n\t\tta[q[i].i]+=q[i].v*(qry(q[i].r)-qry(q[i].l-1));\n\t\t//printf(\"%d %d %d\\n\",q[i].i,q[i].v,(qry(q[i].r)-qry(q[i].l-1)));\n\t}\n\t//for(int i=1;i<=m;i++)\n\t//\tprintf(\"%d\\n\",ans[i]);\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tfor(int j=0;j<4;j++)ans[i]+=(ll)ta[i+j*m]*(ta[i+j*m]-1);\n\t\t//for(int j=0;j<4;j++)printf(\"%d \",ta[i+j*m]);putchar(10);\n\t\tprintf(\"%I64d\\n\",ans[i]/2);\n\t}\n}"], "input": "", "output": "", "tags": ["data structures"], "dificulty": "2100", "interactive": false}