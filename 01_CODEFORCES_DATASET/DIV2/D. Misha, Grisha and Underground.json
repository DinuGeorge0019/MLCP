{"link": "https://codeforces.com//contest/832/problem/D", "problemId": "115520", "problem_idx": "D", "shortId": "832D", "contest_number": "832", "problem_submissions": {"C": [28850414, 28839556, 28849218, 28970707, 28860425, 28882532], "B": [28842559, 28832195, 28832637, 28833745, 28835678, 28833935, 28833416, 28838017, 28839620, 28834185, 28834397, 28835866, 28831820, 28836424, 28834235, 28834452, 28834561, 28834258], "E": [28840011, 28847209, 28846202, 28846322, 28851079, 28847674, 28848843, 28861574, 29694590], "D": [28833290, 28844072, 28839533, 28841064, 28839461, 28842570, 28835402, 28843358, 28835918, 28834140, 28836636, 28838484, 28838783, 28839031, 28841097, 28844392, 28841838, 28840397, 28840613, 28840691], "A": [28827596, 28827231, 28829917, 28828126, 28828610, 28830168, 28827850, 28827000, 28836168, 28827377, 28826850, 28827715, 28827016, 28827260, 28826966, 28827167, 28828034, 28826934, 28827600]}, "name": "D. Misha, Grisha and Underground", "statement": "Misha and Grisha are funny boys, so they like to use new underground.\r\nThe underground has stations connected with routes so that each route\r\nconnects two stations, and it is possible to reach every station from\r\nany other.The boys decided to have fun and came up with a plan. Namely,\r\nin some day in the morning Misha will ride the underground from station\r\nto station by the shortest path, and will draw with aerosol an ugly text\r\n\"Misha was here\" on every station he will pass through (including and ).\r\nAfter that on the same day at evening Grisha will ride from station to\r\nstation by the shortest path and will count stations with Misha\u2019s text.\r\nAfter that at night the underground workers will wash the texts out,\r\nbecause the underground should be clean. The boys have already chosen\r\nthree stations , and for each of several following days, one of them\r\nshould be station on that day, another should be station , and the\r\nremaining should be station . They became interested how they should\r\nchoose these stations , , so that the number Grisha will count is as\r\nlarge as possible. They asked you for help.\r\n", "solutions": ["#include<stdio.h>\n#include<algorithm>\n#include<vector>\nusing namespace std;\n\nint N, Q; vector<int> con[101010];\nint lv[101010], par[101010][18];\n\nint lca(int a, int b){\n\tif(lv[a] < lv[b]) swap(a,b);\n\tfor(int i=17; i>=0; i--){\n\t\tif(lv[a]-lv[b] >= (1<<i)) a = par[a][i];\n\t}\n\tif(a == b) return a;\n\tfor(int i=17; i>=0; i--){\n\t\tif(par[a][i] != par[b][i]) a = par[a][i], b = par[b][i];\n\t}\n\treturn par[a][0];\n}\n\nint dist(int a, int b){\n\tint m = lca(a, b);\n\treturn lv[a]+lv[b]-2*lv[m];\n}\n\nvoid dfs(int ix){\n\tfor(auto &e : con[ix]){\n\t\tif(e == par[ix][0]) continue;\n\t\tpar[e][0] = ix; lv[e] = lv[ix]+1;\n\t\tdfs(e);\n\t}\n}\n\nint main(){\n\tscanf(\"%d%d\", &N, &Q);\n\tfor(int i=2; i<=N; i++){\n\t\tint e;\n\t\tscanf(\"%d\", &e);\n\t\tcon[i].push_back(e);\n\t\tcon[e].push_back(i);\n\t}\n\tpar[1][0] = 0; dfs(1);\n\tfor(int i=1; i<18; i++){\n\t\tfor(int j=1; j<=N; j++) par[j][i] = par[par[j][i-1]][i-1];\n\t}\n\tfor(int i=Q; i--;){\n\t\tint a, b, c, m1, m2, m3, m;\n\t\tscanf(\"%d%d%d\", &a, &b, &c);\n\t\tm1 = lca(a,b); m2 = lca(a,c); m3 = lca(b,c);\n\t\tif(m1 == m2) m = m3;\n\t\telse if(m1 == m3) m = m2;\n\t\telse m = m1;\n\t\tprintf(\"%d\\n\", 1+max(max(dist(m,a),dist(m,b)),dist(m,c)));\n\t}\n\treturn 0;\n}\n"], "input": "", "output": "", "tags": ["dfs and similar", "graphs", "trees"], "dificulty": "1900", "interactive": false}