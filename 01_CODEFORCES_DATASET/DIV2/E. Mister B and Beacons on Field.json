{
    "link": "https://codeforces.com//contest/820/problem/E",
    "problemId": "112032",
    "problem_idx": "E",
    "shortId": "820E",
    "contest_number": "820",
    "problem_submissions": {
        "D": [
            28090049,
            28137649,
            28088664,
            28094955,
            28089529,
            28089527,
            28090859,
            28089173,
            28091024,
            28094638,
            28089824,
            28091652,
            28090283,
            28091750,
            28092540,
            28091733,
            28092897,
            28093521,
            28094268
        ],
        "B": [
            28083049,
            28106071,
            28082021,
            28080745,
            28083623,
            28081407,
            28080513,
            28081950,
            28082191,
            28081439,
            28083924,
            28081732,
            28083872,
            28083485,
            28080808,
            28085943,
            28080448,
            28082955,
            28081466
        ],
        "A": [
            28080531,
            28105895,
            28079641,
            28078276,
            28078539,
            28078543,
            28078629,
            28078567,
            28078870,
            28078269,
            28078946,
            28078387,
            28078624,
            28079616,
            28078334,
            28079395,
            28078375,
            28078673,
            28078593
        ],
        "C": [
            28113571,
            28113484,
            28106533,
            143980051
        ],
        "E": [
            28279885,
            28136857
        ]
    },
    "name": "E. Mister B and Beacons on Field",
    "statement": "Mister B has a house in the middle of a giant plain field, which\r\nattracted aliens life. For convenience, aliens specified the Cartesian\r\ncoordinate system on the field in such a way that Mister B’s house has\r\ncoordinates . After that they sent three beacons to the field, but\r\nsomething went wrong. One beacon was completely destroyed, while the\r\nother two landed in positions with coordinates and , respectively, but\r\nshut down.Mister B was interested in this devices, so he decided to take\r\nthem home. He came to the first beacon, placed at , lifted it up and\r\ncarried the beacon home choosing the shortest path. After that he came\r\nto the other beacon, placed at , and also carried it home choosing the\r\nshortest path. When first beacon was lifted up, the navigation system of\r\nthe beacons was activated.Partially destroyed navigation system started\r\nto work in following way.At time moments when both survived beacons are\r\nat points with integer coordinates the system tries to find a location\r\nfor the third beacon. It succeeds if and only if there is a point with\r\ninteger coordinates such that the area of the triangle formed by the two\r\nsurvived beacons and this point is equal to . In this case the system\r\nsends a packet of information with beacon positions to aliens, otherwise\r\nit doesn’t.Compute how many packets of information system sent while\r\nMister B was moving the beacons.\r\n",
    "solutions": [
        "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long int64;\ntypedef tuple<int, int, int64> divisor;\nconst int MAXD = 1000010;\nvector<divisor> dn, ds; vector<int64> z;\nint64 n, m, s;\n\nint mindiv[MAXD], prm[MAXD], sum;\nvoid sieve() {\n\tmemset(mindiv, 0, sizeof(mindiv)), sum = 0;\n\tfor (int i = 2; i < MAXD; ++i) {\n\t\tif (!mindiv[i])\n\t\t\tprm[++sum] = i, mindiv[i] = i;\n\t\tfor (int j = 1; j <= sum; ++j) {\n\t\t\tif (i * prm[j] >= MAXD) break;\n\t\t\tmindiv[i*prm[j]] = prm[j];\n\t\t\tif (i % prm[j] == 0) break;\n\t\t}\n\t}\n}\n\nvoid fact(vector<divisor> &dn, int n) {\n\tvector<divisor> temp = dn; dn.clear();\n\twhile (n != 1) {\n\t\tint d = mindiv[n];\n\t\tif (!temp.empty() && get<0>(temp.back()) == d)\n\t\t\t++get<1>(temp.back()), get<2>(temp.back()) *= d;\n\t\telse temp.push_back(divisor(d, 1, d));\n\t\tn /= d;\n\t}\n\tsort(temp.begin(), temp.end());\n\tfor (int l = 0, r = 0; r < temp.size(); l = r) {\n\t\tint pd = get<0>(temp[l]), t = 0; int64 d = 1;\n\t\twhile (r < temp.size() && get<0>(temp[r]) == pd)\n\t\t\tt += get<1>(temp[r]), d *= get<2>(temp[r]), ++r;\n\t\tdn.push_back(divisor(pd, t, d));\n\t}\n}\n\nint64 count2(int dep, int64 val) {\n\tif (val > n) return 0;\n\tif (dep == ds.size()) return 1;\n\tint pd = get<0>(ds[dep]); int64 d = get<2>(ds[dep]);\n\tint64 cur = 1, ans = 0;\n\tfor (; cur <= d; cur *= pd)\n\t\tans += count2(dep + 1, val * cur);\n\treturn ans;\n}\nint64 count1(int dep, int sign, int64 val) {\n\tif (val > m) return 0;\n\tif (dep == z.size())\n\t\treturn sign * (m / val);\n\tint64 ans1 = count1(dep + 1, sign, val);\n\tint64 ans2 = count1(dep + 1, -sign, val * z[dep]);\n\treturn ans1 + ans2;\n}\n\nint main() {\n\tsieve(); int T;\n\tfor (cin >> T; T > 0; --T) {\n\t\tint64 n1, n2, n3, m1, m2, m3, s1, s2, s3;\n\t\tcin >> n1 >> n2 >> n3; n = n1 * n2 * n3;\n\t\tcin >> m1 >> m2 >> m3; m = m1 * m2 * m3;\n\t\tcin >> s1 >> s2 >> s3; s = s1 * s2 * s3 * 2;\n\t\t\n\t\tdn.clear(), ds.clear(), ds.push_back(divisor(2, 1, 2));\t\n\t\tfact(dn, n1), fact(dn, n2), fact(dn, n3);\n\t\tfact(ds, s1), fact(ds, s2), fact(ds, s3);\n\t\t\n\t\tz.clear();\n\t\tfor (int i = 0, j = 0; i < dn.size(); ++i) {\n\t\t\twhile (j < ds.size() && get<0>(dn[i]) > get<0>(ds[j]))\n\t\t\t\t++j;\n\t\t\tif (j != ds.size() && get<0>(dn[i]) == get<0>(ds[j])) {\n\t\t\t\tif (get<1>(dn[i]) > get<1>(ds[j]))\n\t\t\t\t\tz.push_back(get<2>(ds[j]) * get<0>(ds[j]));\t\t\t\n\t\t\t}\n\t\t\telse z.push_back(get<0>(dn[i]));\n\t\t}\n\t\t\n\t\tcout << count1(0, +1, 1) + count2(0, 1) << endl;\n\t}\n\treturn 0;\n}"
    ],
    "input": "",
    "output": "",
    "tags": [],
    "dificulty": "2900",
    "interactive": false,
    "file_name": "D:\\scoala\\RESEARCH\\MLCP\\01_CODEFORCES_DATASET\\DIV2\\E. Mister B and Beacons on Field.json",
    "editorial_link": "https://codeforces.com//blog/entry/52946",
    "editorial": null
}