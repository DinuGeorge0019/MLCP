{"link": "https://codeforces.com//contest/1182/problem/E", "problemId": "356990", "problem_idx": "E", "shortId": "1182E", "contest_number": "1182", "problem_submissions": {"D": [55455650, 55586970, 55459316, 55455659, 55458949, 55453924, 55478512, 55482188, 55498428, 55481213, 55567538, 55453786], "E": [55450747, 55461164, 55449899, 55449075, 55460684, 55454104, 55453180, 55453677, 55453916, 55451090, 55454249, 55453623, 55476218, 55446106, 55449885, 55454784, 55483027, 55456083, 55457367, 55456526], "A": [55445533, 55434238, 55434241, 55436061, 55434955, 55434411, 55437033, 55434181, 55435131, 55435071, 55434914, 55434583, 55476206, 55434538, 55436427, 55434458, 55434180, 55434233, 55434292, 55434474], "B": [55445010, 55437924, 55440985, 55440064, 55439189, 55438618, 55443275, 55439911, 55437513, 55438913, 55441336, 55438725, 55438778, 55476210, 55439290, 55442014, 55440569, 55438740, 55438330, 55438657, 55438254], "C": [55442056, 55444294, 55448723, 55461519, 55444763, 55447324, 55449390, 55446594, 55444945, 55447149, 55449216, 55447861, 55449136, 55476215, 55459225, 55455453, 55447166, 55483042, 55444199, 55447099, 55446909, 55445149], "F": [55479857]}, "name": "E. Product Oriented Recurrence", "statement": "Let f_{x} = c^{2x-6}\r\ncdot f_{x-1}\r\ncdot f_{x-2}\r\ncdot f_{x-3} for x\r\nge 4.You have given integers n, f_{1}, f_{2}, f_{3}, and c. Find f_{n}\r\nbmod (10^{9}+7).\r\n", "solutions": ["#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> pii;\ntypedef vector<int> vi;\ntypedef vector<pii> vpii;\ntypedef map<int,int> mii;\n#define itr iterator\nconst int Ha=1000000007;\nconst int phi=1000000006;\nstruct matrix\n{\n\tint a[5][5];\n\tmatrix(){memset(a,0,sizeof(a));}\n}t;\ninline matrix operator*(const matrix&a,const matrix&b)\n{\n\tmatrix c;\n\tfor(int i=0;i<5;++i)\n\t\tfor(int j=0;j<5;++j)\n\t\t\tfor(int k=0;k<5;++k)\n\t\t\t\tc.a[i][j]=(c.a[i][j]+1ll*a.a[i][k]*b.a[k][j])%phi;\n\treturn c;\n}\ninline matrix fp(matrix b,long long e)\n{\n\tmatrix r;\n\tfor(int i=0;i<5;++i)r.a[i][i]=1;\n\tfor(;e;e>>=1,b=b*b)if(e&1)r=r*b;\n\treturn r;\n}\nmap<int,int>mp;\nint B=1;\nint fp(int b,int e)\n{\n\tint r=1;\n\tfor(;e;e>>=1,b=1ll*b*b%Ha)if(e&1)r=1ll*r*b%Ha;\n\treturn r;\n}\nint dlog(int x)\n{\n\tint now=1;\n\tint res;\n\tfor(int i=0;;++i)\n\t{\n\t\tint y=1ll*x*now%Ha;\n\t\tif(mp.count(y))\n\t\t{\n\t\t\tres=mp[y]-i*33333;\n\t\t\tbreak;\n\t\t}\n\t\tnow=1ll*now*B%Ha;\n\t}\n\tres=(res+phi)%phi;\n\tres=(res+phi)%phi;\n\tres=(res+phi)%phi;\n\tassert(fp(5,res)==x);\n\treturn res;\n}\nint z[5];\nint main()\n{\n\tfor(int i=0;i<33333;++i)\n\t{\n\t\tmp[B]=i;\n\t\tB=5ll*B%Ha;\n\t}\n\tlong long n;\n\tint f1,f2,f3,c;\n\tscanf(\"%lld%d%d%d%d\",&n,&f1,&f2,&f3,&c);\n\tc=dlog(c);\n\tf1=dlog(f1);\n\tf2=dlog(f2);\n\tf3=dlog(f3);\n\tt.a[0][1]=1;\n\tt.a[1][2]=1;\n\tt.a[1][0]=1;\n\tt.a[0][0]=1;\n\tt.a[1][0]=1;\n\tt.a[2][0]=1;\n\tt.a[3][3]=1;\n\tt.a[3][0]=(phi-6ll*c%phi)%phi;\n\tt.a[4][0]=2ll*c%phi;\n\tt.a[3][4]=1;\n\tt.a[4][4]=1;\n\tz[0]=f3;\n\tz[1]=f2;\n\tz[2]=f1;\n\tz[3]=1;\n\tz[4]=4;\n\tt=fp(t,n-3);\n\tint res=0;\n\tfor(int i=0;i<5;++i)res=(res+1ll*z[i]*t.a[i][0])%phi;\n\tprintf(\"%d\\n\",fp(5,res));\n\treturn 0;\n}"], "input": "", "output": "", "tags": ["dp", "math", "matrices", "number theory"], "dificulty": "2300", "interactive": false}