{"link": "https://codeforces.com//contest/222/problem/C", "problemId": "1638", "problem_idx": "C", "shortId": "222C", "contest_number": "222", "problem_submissions": {"E": [2114302, 2112427, 2113769, 2118198, 2113138, 2117211, 2116587, 2116925, 2112376, 2112549, 2117600, 2115393, 2116550, 2112090, 2117599, 2114599, 2113354, 2115001, 2116489, 2115394], "D": [2113640, 2115490, 2114107, 2114475, 2116493, 2113562, 2117592, 2115503, 2114322, 2113844, 2115759, 2116789, 2117762, 2114698, 2116546, 2115578, 2112252, 2113514, 2111962, 2114392], "C": [2112582, 2114175, 2116212, 2112540, 2115296, 2116020, 2113930, 2113022, 2117883, 2118828, 2118364, 2128042, 2114721, 2135487], "B": [2110124, 2110976, 2110362, 2110813, 2111132, 2110340, 2110934, 2114259, 2110860, 2110665, 2111315, 2113871, 2110626, 2110122, 2112637, 2111026, 2115073, 2109978, 2113250, 2110096], "A": [2109295, 2109423, 2109374, 2109339, 2110128, 2109729, 2109986, 2117404, 2109976, 2109443, 2111894, 2111710, 2109696, 2115927, 2111503, 2109885, 2115483, 2109309, 2111536, 2109416]}, "name": "C. Reducing Fractions", "statement": "To confuse the opponents, the Galactic Empire represents fractions in an\r\nunusual format. The fractions are represented as two sets of integers.\r\nThe product of numbers from the first set gives the fraction numerator,\r\nthe product of numbers from the second set gives the fraction\r\ndenominator. However, it turned out that the programs that work with\r\nfractions in this representations aren\u2019t complete, they lack supporting\r\nthe operation of reducing fractions. Implement this operation and the\r\nEmpire won\u2019t forget you.\r\n", "solutions": ["#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#include <queue>\n#include <map>\n#include <vector>\n#define min(a,b) (((a)<(b))?(a):(b))\nusing namespace std;\n\nbool visit[ 3164 ];\nint prime[ 1000 ], pcnt;\nint faca[ 100001 ][ 10 ][ 2 ], facb[ 100001 ][ 10 ][ 2 ], c1[ 100001 ], c2[ 100001 ], f1[ 10000001 ], f2[ 10000001 ];\n\nvoid init( )\n{\n\tint i, j;\n\tfor ( i = 2; i <= 3163; i++ )\n\t\tif ( !visit[ i ] )\n\t\t{\n\t\t\tprime[ pcnt++ ] = i;\n\t\t\tfor ( j = i * 2; j <= 3163; j += i )\n\t\t\t\tvisit[ j ] = 1;\n\t\t}\n}\n\nint main( )\n{\n\tint n, m, i, j, k, t, p;\n\tscanf(\"%d%d\", &n, &m);\n\tinit( );\n\tfor ( i = 0; i < n; i++ )\n\t{\n\t\tscanf(\"%d\", &t);\n\t\tif ( t == 1 )\n\t\t{\n\t\t\tc1[ i ] = 0;\n\t\t\tcontinue;\n\t\t}\n\t\tfor ( j = 0; prime[ j ] * prime[ j ] <= t; j++ )\n\t\t\tif ( t % prime[ j ] == 0 )\n\t\t\t{\n\t\t\t\tfaca[ i ][ c1[ i ] ][ 0 ] = prime[ j ];\n\t\t\t\twhile ( t % prime[ j ] == 0 )\n\t\t\t\t{\n\t\t\t\t\tt /= prime[ j ];\n\t\t\t\t\tf1[ prime[ j ] ]++;\n\t\t\t\t\tfaca[ i ][ c1[ i ] ][ 1 ]++;\n\t\t\t\t}\n\t\t\t\tc1[ i ]++;\n\t\t\t}\n\t\tif ( t != 1 )\n\t\t{\n\t\t\tfaca[ i ][ c1[ i ] ][ 0 ] = t;\n\t\t\tfaca[ i ][ c1[ i ]++ ][ 1 ] = 1;\n\t\t\tf1[ t ]++;\n\t\t}\n\t}\n\tfor ( i = 0; i < m; i++ )\n\t{\n\t\tscanf(\"%d\", &t);\n\t\tif ( t == 1 )\n\t\t{\n\t\t\tc2[ i ] = 0;\n\t\t\tcontinue;\n\t\t}\n\t\tfor ( j = 0; prime[ j ] * prime[ j ] <= t; j++ )\n\t\t\tif ( t % prime[ j ] == 0 )\n\t\t\t{\n\t\t\t\tfacb[ i ][ c2[ i ] ][ 0 ] = prime[ j ];\n\t\t\t\twhile ( t % prime[ j ] == 0 )\n\t\t\t\t{\n\t\t\t\t\tt /= prime[ j ];\n\t\t\t\t\tf2[ prime[ j ] ]++;\n\t\t\t\t\tfacb[ i ][ c2[ i ] ][ 1 ]++;\n\t\t\t\t}\n\t\t\t\tc2[ i ]++;\n\t\t\t}\n\t\tif ( t != 1 )\n\t\t{\n\t\t\tfacb[ i ][ c2[ i ] ][ 0 ] = t;\n\t\t\tfacb[ i ][ c2[ i ]++ ][ 1 ] = 1;\n\t\t\tf2[ t ]++;\n\t\t}\n\t}\n\tfor ( i = 2; i <= 10000000; i++ )\n\t{\n\t\tt = min( f1[ i ], f2[ i ] );\n\t\tf1[ i ] -= t;\n\t\tf2[ i ] -= t;\n\t}\n\tprintf(\"%d %d\\n\", n, m);\n\tfor ( i = 0; i < n; i++ )\n\t{\n\t\tt = 1;\n\t\tfor ( j = 0; j < c1[ i ]; j++ )\n\t\t\tfor ( k = 0; k < faca[ i ][ j ][ 1 ] && f1[ faca[ i ][ j ][ 0 ] ]; k++ )\n\t\t\t{\n\t\t\t\tf1[ faca[ i ][ j ][ 0 ] ]--;\n\t\t\t\tt *= faca[ i ][ j ][ 0 ];\n\t\t\t}\n\t\tif ( i != 0 ) printf(\" \");\n\t\tprintf(\"%d\", t);\n\t}\n\tputs(\"\");\n\tfor ( i = 0; i < m; i++ )\n\t{\n\t\tt = 1;\n\t\tfor ( j = 0; j < c2[ i ]; j++ )\n\t\t\tfor ( k = 0; k < facb[ i ][ j ][ 1 ] && f2[ facb[ i ][ j ][ 0 ] ]; k++ )\n\t\t\t{\n\t\t\t\tf2[ facb[ i ][ j ][ 0 ] ]--;\n\t\t\t\tt *= facb[ i ][ j ][ 0 ];\n\t\t\t}\n\t\tif ( i != 0 ) printf(\" \");\n\t\tprintf(\"%d\", t);\n\t}\n\tputs(\"\");\n\treturn 0;\n}\n"], "input": "", "output": "", "tags": ["implementation", "math", "number theory", "sortings"], "dificulty": "1800", "interactive": false}