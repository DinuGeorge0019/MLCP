{"link": "https://codeforces.com//contest/1549/problem/F2", "problemId": "1062380", "problem_idx": "F2", "shortId": "1549F2", "contest_number": "1549", "problem_submissions": {"F2": [124954760], "B": [124947565, 124545808, 124541593, 124946530, 124553166, 124545711, 124536914, 124556540, 124566832, 124527986, 124941325, 124545594, 124575237, 124552639, 124521339, 124527240, 124534396, 124536389, 124529098, 124547548, 124525326, 124539590, 124546541], "A": [124947501, 124518305, 124519670, 124946570, 124520785, 124519203, 124517993, 124517559, 124518317, 124518952, 124941237, 124534955, 124569653, 124519648, 124517299, 124518094, 124521899, 124520868, 124518074, 124519228, 124517443, 124519076, 124518992], "F1": [124584680, 124595832, 124599734, 124593371, 124597616, 124593738, 124591194, 124592802, 124602219, 124602384, 124588472, 124753532, 124592653, 124603568, 124595865], "E": [124572687, 124578681, 124586160, 124580564, 124586278, 124587026, 124603080, 124600315, 124577736, 124595081, 124580521, 124597748, 124594829, 124597255, 124685628, 124601974], "D": [124558908, 124554190, 124550650, 124565038, 124571505, 124565266, 124557657, 124634855, 124586699, 124566420, 124566608, 124571026, 124544812, 124558707, 124568055, 124617780, 124551649, 124555888, 124569746, 124549100, 124571724, 124554851], "C": [124534727, 124537090, 124536290, 124552036, 124551687, 124549175, 124538153, 124547780, 124552849, 124553941, 124540508, 124527050, 124538078, 124556164, 124573095, 124538823, 124554597, 124536966, 124553733, 124540516]}, "name": "F2. Gregor and the Odd Cows  Hard ", "statement": "There are n fence-posts at distinct coordinates on a plane. It is\r\nguaranteed that no three fence posts lie on the same line.There are an\r\ninfinite number of cows on the plane, one at every point with integer\r\ncoordinates.Gregor is a member of the Illuminati, and wants to build a\r\ntriangular fence, connecting 3 distinct existing fence posts. A cow\r\ninside the fence is said to be . If there are an number of enclosed cows\r\nand the area of the fence is an , the fence is said to be .Find the\r\nnumber of interesting fences.\r\n", "solutions": ["// Problem: F2. Gregor and the Odd Cows (Hard)\n// Contest: Codeforces - Codeforces Round #736 (Div. 2)\n// URL: https://codeforces.com/contest/1549/problem/F2\n// Memory Limit: 256 MB\n// Time Limit: 6000 ms\n// \n// Powered by CP Editor (https://cpeditor.org)\n\n#include<bits/stdc++.h>\n#define pb push_back\n#define mp make_pair\n#define chkmx(a,b) ((a)=max((a),(b)))\n#define chkmn(a,b) ((a)=min((a),(b)))\nusing namespace std;\ntemplate<typename T>\ninline void read(T &x){x=0;char c=getchar();bool f=false;for(;!isdigit(c);c=getchar())f|=c=='-';for(;isdigit(c);c=getchar())x=x*10+c-'0';if(f)x=-x;}\ntemplate<typename T ,typename ...Arg>inline void read(T &x,Arg &...args){read(x);read(args...);}\ntemplate<typename T>inline void write(T x){if(x<0)putchar('-'),x=-x;if(x>=10)write(x/10);putchar(x%10+'0');}\n//#define int long long\ntypedef long long ll;\nconst int N=6100;\nint n,x[N],y[N],cnt[4][4][4];\nint S2(int x1,int y1,int x2,int y2,int x3,int y3){\n\tint res=x1*(y2-y3)+x2*(y3-y1)+x3*(y1-y2);\n\tres%=4;if(res<0)res+=4;return res;\n}\nsigned main(){\n\tread(n);\n\tfor(int i=1;i<=n;i++)\n\t\tread(x[i],y[i]);\n\tll eee=0,eoo=0;\n\tfor(int i=1;i<=n;i++){\n\t\tmemset(cnt,0,sizeof cnt);\n\t\tfor(int j=1;j<=n;j++)if(i!=j)\n\t\t\tcnt[x[j]%4][y[j]%4][__gcd(abs(x[i]-x[j]),abs(y[i]-y[j]))%4]++;\n\t\tfor(int x1=0;x1<4;x1++)for(int y1=0;y1<4;y1++)for(int b1=0;b1<4;b1++){\n\t\t\tint kk=cnt[x1][y1][b1];cnt[x1][y1][b1]--;\n\t\t\tfor(int x2=x1&1;x2<4;x2+=2)for(int y2=y1&1;y2<4;y2+=2)for(int b2=b1&1;b2<4;b2+=2){\n\t\t\t\tint S=S2(x[i],y[i],x1,y1,x2,y2);\n\t\t\t\tif(S&1)exit(-1);\n\t\t\t\tS>>=1;\n\t\t\t\tint b3=__gcd(abs(x1-x2),abs(y1-y2));\n\t\t\t\tint res=S-(b1+b2+b3)/2+1;\n\t\t\t\tif(res&1){\n\t\t\t\t\tif(b1&1)eoo+=kk*cnt[x2][y2][b2];\n\t\t\t\t\telse eee+=kk*cnt[x2][y2][b2];\n\t\t\t\t}\n\t\t\t}\n\t\t\tcnt[x1][y1][b1]++;\n\t\t}\n\t}\n\twrite(eee/6+eoo/2);\n}"], "input": "", "output": "", "tags": ["geometry", "number theory"], "dificulty": "3300", "interactive": false}