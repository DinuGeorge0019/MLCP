{
    "link": "https://codeforces.com//contest/337/problem/C",
    "problemId": "3393",
    "problem_idx": "C",
    "shortId": "337C",
    "contest_number": "337",
    "problem_submissions": {
        "A": [
            12299505,
            4287779,
            4294787,
            4288908,
            4287593,
            4287655,
            4288715,
            4287767,
            4287597,
            4289361,
            4292228,
            4297873,
            4287659,
            4288000,
            4287546,
            4288581,
            4287692,
            4288502
        ],
        "E": [
            4297308,
            4294426,
            4299642,
            7151846,
            4296911,
            4298400
        ],
        "D": [
            4293164,
            4295622,
            4296185,
            4297268,
            4295484,
            4297391,
            4293932,
            4295013,
            4295647,
            4297089,
            4306458,
            4315672,
            4296531
        ],
        "C": [
            4291413,
            4292827,
            4290434,
            4291634,
            4291820,
            4293004,
            4295602,
            4293040,
            4292436,
            4290283,
            4292545,
            4293113,
            4292103,
            4291206,
            4293573,
            4292596
        ],
        "B": [
            4289325,
            4294106,
            4292267,
            4289473,
            4288898,
            4289573,
            4288545,
            4289624,
            4292085,
            4290934,
            4289760,
            4289731,
            4290149,
            4289634,
            4289994,
            4289149,
            4302088
        ]
    },
    "name": "C. Quiz",
    "statement": "Manao is taking part in a quiz. The quiz consists of consecutive\r\nquestions. A correct answer gives one point to the player. The game also\r\nhas a counter of consecutive correct answers. When the player answers a\r\nquestion correctly, the number on this counter increases by 1. If the\r\nplayer answers a question incorrectly, the counter is reset, that is,\r\nthe number on it reduces to 0. If after an answer the counter reaches\r\nthe number , then it is reset, and the player\u2019s score is doubled. Note\r\nthat in this case, first 1 point is added to the player\u2019s score, and\r\nthen the total score is doubled. At the beginning of the game, both the\r\nplayer\u2019s score and the counter of consecutive correct answers are set to\r\nzero.Manao remembers that he has answered exactly questions correctly.\r\nBut he does not remember the order in which the questions came. He\u2019s\r\ntrying to figure out what his minimum score may be. Help him and compute\r\nthe remainder of the corresponding number after division by .\r\n",
    "solutions": [
        "#include <algorithm>\n#include <cstring>\n#include <cstdlib>\n#include <cstdio>\n#define int64 long long\n#define mo 1000000009\n#define For(i,x,y) for (i=x;i<=y;i++)\nusing namespace std;\nint i,j;\nint64 n,m,k;\nint64 a[2],b[2][2];\ninline void mul(int64 a[2],int64 b[2][2]) {\n    int64 c[2]={0}; int i,j;\n    For(i,0,1)For(j,0,1) c[j]+=a[i]*b[i][j];\n    For(i,0,1) a[i]=c[i]%mo;\n}\ninline void multi(int64 a[2][2],int64 b[2][2]) {\n    int64 c[2][2]={0}; int i,j,u;\n    For(i,0,1)For(j,0,1)For(u,0,1) c[i][u]+=a[i][j]*b[j][u];\n    For(i,0,1)For(j,0,1) a[i][j]=c[i][j]%mo;\n}\ninline int64 work(int64 x) {\n    a[1]=1; b[0][0]=2; b[1][0]=2*k; b[1][1]=1;\n    for (;x;x>>=1) {\n        if (x&1) mul(a,b);\n        multi(b,b);\n    } return a[0];\n}\ninline int64 calc() {\n    int64 B=n/k*(k-1)+n%k;\n    if (B>=m) return m;\n    m-=B;\n    B=B-m*(k-1);\n    return work(m)+B;\n}\nint main() {\n    scanf(\"%I64d%I64d%I64d\",&n,&m,&k);\n    printf(\"%I64d\\n\",calc()%mo);\n    return 0;\n}"
    ],
    "input": "",
    "output": "",
    "tags": [
        "binary search",
        "greedy",
        "math",
        "matrices",
        "number theory"
    ],
    "dificulty": "1600",
    "interactive": false,
    "file_name": "D:\\scoala\\RESEARCH\\MLCP\\01_CODEFORCES_DATASET\\DIV2\\C. Quiz.json",
    "editorial_link": "https://codeforces.com//blog/entry/8629",
    "editorial": "Assume that Manao has doubled his score (i.e. gave k consecutive correct\r\nanswers) exactly X times. Then the least possible score is obtained when\r\nthis doublings happen in the beginning of the game, i.e., when he\r\nanswers the first X*k questions and never manages to answer k\r\nconsecutive questions after that. The correctness of this statement\r\nfollows from the following: for any other scenario with X doublings, all\r\nof these doublings can be moved into the beginning and the total score\r\nwill not increase. Hence, for X=1 Manao\u00e2\u0080\u0099s minimum score is k*2+m-k: he\r\nanswers k consecutive questions, the score doubles, then he answers m-k\r\nquestions. For X=2 the minimum possible score is (k*2+k)*2+m-2*k, for\r\nX=3 ((k*2+k)*2+k)*2+m-3*k. For the general case, a formula\r\n(2^1+2^2+...+2^X)*k + m-X*k = (2^(X+1)-2)*k + m-X*k is derived. The\r\nabovementioned observation shows that the minimum score grows\r\nmonotonically when X is increased, so all we need is to find the minimum\r\nfeasible X. It should satisfy the inequalities X*k <= n and X + (n - n\r\nmod k) / k * (k-1) + n mod k >= m. More on the second inequality: Manao\r\nanswered the first X*k questions, thus there are n-X*k left. Now he can\r\nanswer at most k-1 question from each k questions. If k divides n-X*k\r\n(which is the same as k divides n), the inequality becomes X*k + (n-X*k)\r\n/ k * (k-1) >= m, but the remainder complicates it a bit: X*k + (n -\r\nX*k - (n - X*k) mod k) / k * (k-1) + (n - X*k) mod k >= m. This formula\r\ncan be simplified to the one written earlier. So, the minimum X is equal\r\nto max(0, m - (n - n mod k) / k * (k-1) - n mod k). You\u00e2\u0080\u0099ll need\r\nexponentiation by squaring to compute the score corresponding to this\r\nvalue of X. Thus, the overall complexity of this solution is O(log(n)).\r\n"
}