{
    "link": "https://codeforces.com//contest/1323/problem/E",
    "problemId": "555654",
    "problem_idx": "E",
    "shortId": "1323E",
    "contest_number": "1323",
    "problem_submissions": {
        "E": [
            72646123,
            72653285,
            72643665,
            72638538,
            72651824,
            72641452,
            73215564,
            74923998,
            74923708,
            73375083
        ],
        "D": [
            72641565,
            72643228,
            72648719,
            72647003,
            72657000,
            72637909,
            72646207,
            72643501,
            72637563,
            72646014,
            72647579,
            72648996,
            72648307,
            72652014,
            72649186,
            72646691,
            72649030,
            72650695,
            72651530
        ],
        "B": [
            72636401,
            72633103,
            72651379,
            72658721,
            72640042,
            72636596,
            72635014,
            72632358,
            72634390,
            72641816,
            72634710,
            72636519,
            72636057,
            72635279,
            72633123,
            72635193,
            72638653,
            72635061,
            72634039,
            72635382
        ],
        "A": [
            72633163,
            72628485,
            72649551,
            72644013,
            72634218,
            72632880,
            72629084,
            72628191,
            72629890,
            72628412,
            72628653,
            72634993,
            72629129,
            72628869,
            72628314,
            72629285,
            72631475,
            72629827,
            72628727,
            72629930
        ],
        "C": [
            72632322,
            72637080,
            72632032,
            72656932,
            72642708,
            72635949,
            72629179,
            72635274,
            72637583,
            72643824,
            72637576,
            72633880,
            72637844,
            72637960,
            72635809,
            72640203,
            72642430,
            72637773,
            72640096,
            72637917
        ],
        "F": [
            72957747
        ]
    },
    "name": "E. Instant Noodles",
    "statement": "Wu got hungry after an intense training session, and came to a nearby\r\nstore to buy his favourite instant noodles. After Wu paid for his\r\npurchase, the cashier gave him an interesting task.You are given a\r\nbipartite graph with positive integers in all vertices of the half. For\r\na subset S of vertices of the half we define N(S) as the set of all\r\nvertices of the right half adjacent to at least one vertex in S, and\r\nf(S) as the sum of all numbers in vertices of N(S). Find the greatest\r\ncommon divisor of f(S) for all possible non-empty subsets S (assume that\r\nGCD of empty set is 0).Wu is too tired after his training to solve this\r\nproblem. Help him!\r\n",
    "solutions": [
        "#include<bits/stdc++.h>\n\nusing namespace std;\n\n#define ll  long long\n#define ld  double\n\n#define sz(x)   (int)x.size()\n#define all(x)  x.begin(),x.end()\n\n#define pb  emplace_back\n#define X   first\n#define Y   second\n\nconst int   N   = 5e5 + 5;\n\ntypedef pair<int,int>   ii;\ntypedef vector<int>     vi;\n\nint main()  {\n    ios_base::sync_with_stdio(0);\n    cin.tie(0); cout.tie(0);\n\n    int itest;\n    cin >> itest;\n\n    while (itest--) {\n        int n;  cin >> n;\n        int m;  cin >> m;\n\n        vector<vi>  g(n);\n        vector<ll>  c(n);\n\n        for(int i = 0 ; i < n ; ++i)    cin >> c[i];\n        for(int i = 0 ; i < m ; ++i)    {\n            int x;  cin >> x;\n            int y;  cin >> y;\n\n            g[y - 1].pb(x);\n        }\n        map<vi,ll>  mp;\n\n        for(int i = 0 ; i < n ; ++i)    if (g[i].size())    {\n            sort(all(g[i]));\n            mp[g[i]] += c[i];\n        }\n        ll  ans = 0;\n\n        for(auto it : mp)\n            ans = __gcd(ans,it.second);\n\n        cout << ans << \"\\n\";\n    }\n}"
    ],
    "input": "",
    "output": "",
    "tags": [
        "graphs",
        "math",
        "number theory"
    ],
    "dificulty": "2300",
    "interactive": false,
    "file_name": "D:\\scoala\\RESEARCH\\MLCP\\01_CODEFORCES_DATASET\\DIV2\\E. Instant Noodles.json",
    "editorial_link": "https://codeforces.com//blog/entry/74148",
    "editorial": "Let's split vertices of right half of graph in groups in such a way that group consists of vertices with same neighboring set. Then answer equals to gcd\n of sums of numbers in all groups except the group with empty neighboring set. Let's prove it.\n\nIf there are some vertices with same list of neighbors then they will both in some N(S)\n or none of them will be in it. It means that we can replace such vertices with one vertex with value equals to sum of values in these vertices. After that numbers in all vertices are divisible by answer and thus sum of every subset is divisible by it. Let's divide all the numbers by answer and prove that after it answer will be 1.\n\nConsider some integer k\n and we'll find some set of vertices S\n such that f(S)\n is not divisible by k\n. If sum of all numbers is not divisible by k\n we can take all the left half and its sum is not divisible by k\n. Otherwise consider a vertex with minimum degree such that its value is not divisible by k\n (such vertex exists because gcd of numbers in right half is 1 now). Let's take subset of vertices in left part which are not connected to v\n. Which vertices are not neighboring to this set? It is v\n and all the vertices that their neighboring set it a subset of neighboring set of v\n (and their sum is divisible by k\n). But value of v\n is not divisible by k\n so sum in complement of its neighboring set is not divisible by k\n too."
}