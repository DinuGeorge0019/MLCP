{"link": "https://codeforces.com//contest/1877/problem/D", "problemId": "2251955", "problem_idx": "D", "shortId": "1877D", "contest_number": "1877", "problem_submissions": {"F": [227174558, 227466890, 227293603, 227329252], "E": [227163070, 227145733, 227144090, 227153972, 227157518, 227156560, 227163724, 227161365, 227162255, 227162229, 227160325, 227160791, 227163873, 227162598, 227166392, 227166841, 227158401, 227162185, 227162372], "D": [227138699, 227131389, 227129888, 227134099, 227129112, 227133071, 227133077, 227144267, 227136086, 227139472, 227138655, 227139596, 227138226, 227141861, 227140431, 227137088, 227140648, 227146399, 227136902], "C": [227133414, 227127308, 227127530, 227125282, 227126156, 227610507, 227128623, 227127297, 227125856, 227127429, 227131821, 227132500, 227131322, 227128501, 227133505, 227132343, 227131403, 227133386, 227133010, 227130729], "B": [227128215, 227121053, 227122944, 227120105, 227119973, 227121777, 227121712, 227120149, 227123349, 227121082, 227122657, 227123511, 227122887, 227123130, 227122430, 227122300, 227131461, 227125290, 227124467], "A": [227124912, 227116905, 227115298, 227115060, 227115015, 227610458, 227116248, 227116367, 227115306, 227116532, 227115007, 227115508, 227115261, 227115583, 227117792, 227115925, 227115499, 227117913, 227116538, 227116495]}, "name": "D. Effects of Anti Pimples", "statement": "Chaneka has an array [a_1,a_2,\r\nldots,a_n]. Initially, all elements are white. Chaneka will choose one\r\nor more different indices and colour the elements at those chosen\r\nindices black. Then, she will choose all white elements whose indices\r\nare multiples of the index of black element and colour those elements\r\ngreen. After that, her score is the value of a_i out of all black and\r\ngreen elements.There are 2^n-1 ways for Chaneka to choose the black\r\nindices. Find the sum of scores for all possible ways Chaneka can choose\r\nthe black indices. Since the answer can be very big, print the answer\r\nmodulo 998\r\n,244\r\n,353.\r\n", "solutions": ["#include <bits/stdc++.h>\n#define int long long \n#define pb push_back\nusing namespace std;\nconst int INF=1e6+5;\nconst int Mod=998244353;\nint n,m,k,p[INF],vis[INF],a[INF];\nvector <int> d[INF];\nint ksm(int x,int y) {\n\tint ba=x%Mod,ans=1;\n\twhile (y) {\n\t\tif (y&1) ans=(ans*ba)%Mod;\n\t\tba=(ba*ba)%Mod;y>>=1;\n\t}\n\treturn ans;\n}\nvoid solve(){\n\tcin>>n;\n\tfor (int i=1;i<=n;i++) {\n\t\tfor (int j=i;j<=n;j+=i)\n\t\t\td[j].pb(i);\n\t}\n\tfor (int i=1;i<=n;i++) cin>>a[i],p[i]=i;\n\tsort(p+1,p+1+n,[](int x,int y){return a[x]>a[y];});\n\tint sum=n,res=0;\n\tfor (int I=1;I<=n;I++) {\n\t\tint i=p[I],fl=1;\n\t\tif (vis[i]) continue;\n\t\tfor (int j=i;j<=n;j+=i)\n\t\t\tif (vis[j]) fl=0;\n\t\tif (fl) res+=ksm(2,sum-1)*a[i]%Mod,res%=Mod;\n\t\tint cnt=0;\n\t\tfor (int k:d[i]) {\n\t\t\tif (vis[k]) ;\n\t\t\telse cnt++;\n\t\t}\n\t\tcnt--;\n\t\tres+=(ksm(2,sum-1)-ksm(2,sum-1-cnt))*a[i]%Mod;\n\t\tres%=Mod;res+=Mod;res%=Mod;\n\t\tfor (int k:d[i]) {\n\t\t\tif (!vis[k]) sum--;\n\t\t\tvis[k]=1;\n\t\t}\n\t}\n\tcout<<res<<\"\\n\";\n}\nsigned main()\n{\n\tios::sync_with_stdio(false);\n\tint t=1;\n\twhile (t--) solve();\n\treturn 0;\n}"], "input": "", "output": "", "tags": ["combinatorics", "number theory", "sortings"], "dificulty": "1500", "interactive": false}