{"link": "https://codeforces.com//contest/1604/problem/F", "problemId": "1163967", "problem_idx": "F", "shortId": "1604F", "contest_number": "1604", "problem_submissions": {"E": [133665266, 133665330, 133659495, 133662698, 133665754, 133665695, 133667913, 133670360, 133670641, 133670753, 133676806, 133672911, 133673104, 133674991, 133676775, 133679158, 133677605, 133683514, 133682221, 133683564], "D": [133632914, 133634675, 133646997, 133640774, 133645923, 133643402, 133646411, 133639935, 133645645, 133646807, 133649571, 133658060, 133654131, 133649231, 133663364, 133653039, 133654438, 133653052, 133653688, 133661097], "C": [133630411, 133638085, 133632064, 133625685, 133635045, 133633934, 133631657, 133625520, 133634475, 133635072, 133633002, 133634939, 133644373, 133640982, 133632402, 133642673, 133644331, 133633661, 133631330, 133642353], "B": [133625396, 133621698, 133626014, 133619603, 134090905, 133624581, 133623770, 133621459, 133634337, 133628885, 133630875, 133627020, 133622232, 133627089, 133635361, 133623364, 133634078, 133623924, 133625391, 133624417, 133621609], "A": [133617599, 133618208, 133617413, 133617141, 134090791, 133617364, 133617444, 133617618, 133619480, 133619710, 133620324, 133618064, 133617109, 133626724, 133628136, 133617925, 133618078, 133619587, 133619073, 133618066, 133617633], "F": [133735630, 133826813]}, "name": "F. Artistic Partition", "statement": "For two positive integers l and r (l\r\nle r) let c(l, r) denote the number of integer pairs (i, j) such that l\r\nle i\r\nle j\r\nle r and\r\noperatorname{gcd}(i, j)\r\nge l. Here,\r\noperatorname{gcd}(i, j) is the greatest common divisor (GCD) of integers\r\ni and j.YouKn0wWho has two integers n and k where 1\r\nle k\r\nle n. Let f(n, k) denote the minimum of\r\nsum\r\nlimits_{i=1}^{k}{c(x_i+1,x_{i+1})} over all integer sequences 0=x_1\r\nlt x_2\r\nlt\r\nldots\r\nlt x_{k}\r\nlt x_{k+1}=n.Help YouKn0wWho find f(n, k).\r\n", "solutions": ["#pragma GCC optimize(2)\n#pragma GCC target(\"avx,sse2,sse3,sse4,mmx\")\n#pragma GCC optimize(3,\"Ofast\",\"inline\")\n\n#include<iostream>\n#include<iomanip>\n#include<cmath>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#include<vector>\nusing namespace std;\nconst int Mxdt=100000,N=100000;\nconst long long INF=1e18;\nchar gc(){\n\tstatic char buf[Mxdt],*p1=buf,*p2=buf;\n\treturn p1==p2&&(p2=(p1=buf)+fread(buf,1,Mxdt,stdin),p1==p2)?EOF:*p1++;\n}\nint read(){\n\tint a=0;bool opt=0;char c=gc();\n\twhile(c<'0'||c>'9')opt|=c=='-',c=gc();\n\twhile(c>='0'&&c<='9')a=(a<<3)+(a<<1)+(c^48),c=gc();\n\treturn opt?-a:a;\n}\ninline char pc(char ch,bool bj){\n\tstatic char buf[Mxdt],*p1=buf,*p2=buf+Mxdt;\n\treturn (bj||(*p1++=ch)&&p1==p2)&&fwrite(p1=buf,1,p1-buf,stdout),0;\n}\nvoid print(long long x)\n{\n\tif(x>9)print(x/10);\n\tpc(x%10^48,false);\n}\ninline void printnum(long long x,char ch)\n{\n\tif(x<0)pc('-',false),x=-x;\n\tprint(x),pc(ch,false);\n}\nint T,n,k,vis[100005],prime[100005],tot,phi[100005];long long f[100005][20];\nint root[20],cnt,ls[4000005],rs[4000005];long long Min[4000005],tag[4000005];\nint newnode(){\n\t++cnt;Min[cnt]=INF;return cnt;\n}\nvoid Tag(int p,int x){if(!p)return;\n\ttag[p]+=x;if(Min[p]<INF)Min[p]+=x;\n}\nvoid pushdown(int p){\n\tif(tag[p]){\n\t\tTag(ls[p],tag[p]);\n\t\tTag(rs[p],tag[p]);\n\t\ttag[p]=0;\n\t}\n}\nvoid Change(int&p,int l,int r,int L,int R,int v){\n\tif(!p)return;\n\tif(L<=l&&r<=R){Tag(p,v);return;}\n\tint mid=l+r>>1;pushdown(p);\n\tif(L<=mid)Change(ls[p],l,mid,L,R,v);\n\tif(R>mid)Change(rs[p],mid+1,r,L,R,v);\n\tMin[p]=min(Min[ls[p]],Min[rs[p]]);\n}\nvoid change(int&p,int l,int r,int x,long long v){\n\tif(!p)p=newnode();\n\tif(l==r){Min[p]=v;return;}\n\tint mid=l+r>>1;pushdown(p);\n\tif(x<=mid)change(ls[p],l,mid,x,v);\n\telse change(rs[p],mid+1,r,x,v);\n\tMin[p]=min(Min[ls[p]],Min[rs[p]]);\n}\nint main(){\n\tphi[1]=1;\n\tfor(int i=2;i<=N;++i){\n\t\tif(!vis[i]){\n\t\t\tprime[++tot]=i;\n\t\t\tphi[i]=i-1;\n\t\t}\n\t\tfor(int j=1;j<=tot;++j){\n\t\t\tif(i*prime[j]>N)break;\n\t\t\tvis[i*prime[j]]=1;\n\t\t\tphi[i*prime[j]]=phi[i]*(prime[j]-1);\n\t\t\tif(i%prime[j]==0){\n\t\t\t\tphi[i*prime[j]]=phi[i]*prime[j];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tMin[0]=INF;change(root[0],1,N,1,0);\n\tfor(int i=1;i<=N;++i){\n\t\tint x=i;\n\t\tfor(int j=1;j*j<=x;++j){\n\t\t\tif(x%j==0){\n\t\t\t\tfor(int k=0;k<=16;++k){\n\t\t\t\t\tChange(root[k],1,N,1,j,phi[x/j]);\n\t\t\t\t\tif(x/j!=j){\n\t\t\t\t\t\tChange(root[k],1,N,1,x/j,phi[j]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int j=1;j<=16;++j)f[i][j]=Min[root[j-1]];\n\t\tfor(int j=1;j<=16;++j){\n\t\t\tchange(root[j],1,N,i+1,f[i][j]);\n\t\t}\n\t}\n\tT=read()+1;\n\twhile(--T){\n\t\tn=read();k=read();\n\t\tif(k>16)printnum(n,'\\n');\n\t\telse printnum(f[n][k],'\\n');\n\t}\n\treturn pc('o',true);\n}"], "input": "", "output": "", "tags": ["dp", "number theory"], "dificulty": "3000", "interactive": false}