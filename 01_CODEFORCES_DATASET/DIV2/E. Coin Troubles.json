{"link": "https://codeforces.com//contest/284/problem/E", "problemId": "2749", "problem_idx": "E", "shortId": "284E", "contest_number": "284", "problem_submissions": {"E": [3341226, 3353475, 3343324, 3353178], "D": [3337803, 3336986, 3340096, 3341173, 3340691, 3339899, 3340120, 3339291, 3340036, 3341486, 3341356, 3342241, 3341587, 3342115, 3346065, 3341238, 3343309, 3343011], "C": [3335356, 3332695, 3336015, 3336648, 3334688, 3335244, 3335583, 3335090, 3334507, 3335320, 3334500, 3333846, 3335893, 3335956, 3336047, 3336868, 3335897, 3337388], "B": [3332715, 3332443, 3333109, 3331686, 3332328, 3331846, 3333568, 3332403, 3332456, 3332720, 3332071, 3332021, 3333154, 3332185, 3333676, 3334151, 3332524], "A": [3331616, 3334567, 3333705, 3331100, 3331416, 3331211, 3332690, 3331528, 3331275, 3331564, 3331148, 3331373, 3331841, 3331566, 3333186, 3332159, 3332364, 3331710]}, "name": "E. Coin Troubles", "statement": "In the Isle of Guernsey there are different types of coins. For each ,\r\ncoin of type is worth cents. It is possible that for some and . Bessie\r\nhas some set of these coins totaling cents. She tells Jessie pairs of\r\nintegers. For each , the pair tells Jessie that Bessie has a strictly\r\ngreater number of coins of type than coins of type . It is known that\r\nall are distinct and all are distinct. Help Jessie find the number of\r\npossible combinations of coins Bessie could have. Two combinations are\r\nconsidered different if there is some , such that the number of coins\r\nBessie has of type is different in the two combinations. Since the\r\nanswer can be very large, output it modulo . If there are no possible\r\ncombinations of coins totaling cents that satisfy Bessie\u2019s conditions,\r\noutput 0.\r\n", "solutions": ["#include <cstdio>\ntypedef\tlong long\tll;\nconst\tll\tmaxn = 310;\nconst\tll\tmaxd = 110000;\nconst\tll\tp = 1000000007;\nll\ta[maxn], ind[maxn], nxt[maxn], b[maxn], sta[maxn], twp[maxn], subs[maxn];\nll\tdp[maxd];\nll\tn, q, t, u, v, st, ed, lsta, ltwp;\nint\tmain()\n{\n//\tfreopen(\"e.in\", \"r\", stdin);\n//\tfreopen(\"e.out\", \"w\", stdout);\n\tscanf(\"%d%d%d\", &n, &q, &t);\n\tfor (ll i=1; i<=n; i++) scanf(\"%d\", &a[i]);\n\tfor (ll i=1; i<=q; i++)\n\t{\n\t\tscanf(\"%d%d\", &u, &v);\n\t\tind[v] ++; nxt[u] = v;\n\t}\n\tst = ed = lsta = 0;\n\tfor (ll i=1; i<=n; i++) if (!ind[i]) b[++ed] = i, sta[++lsta] = i;\n\twhile (st < ed)\n\t{\n\t\tll i = b[++st];\n\t\tif (!(--ind[nxt[i]])) b[++ed] = nxt[i];\n\t}\n\tif (ed < n) {printf(\"0\\n\"); return 0;}\n\tfor (ll i=1; i<=lsta; i++)\n\t{\n\t\ttwp[ltwp = 1] = sta[i];\n\t\twhile (nxt[twp[ltwp]]) twp[ltwp + 1] = nxt[twp[ltwp]], ltwp++;\n\t\tfor (ll j=1; j<=ltwp; j++) subs[j] = a[twp[j]];\n\t\tfor (ll j=2; j<=ltwp; j++) subs[j] += subs[j - 1];\n\t\tfor (ll j=1; j<=ltwp; j++) a[twp[j]] = subs[j];\n\t\tfor (ll j=1; j<ltwp; j++)\n\t\t{\n\t\t\tt -= subs[j];\n\t\t\tif (t < 0) break;\n\t\t}\n\t\tif (t < 0) break;\n\t}\n\tif (t < 0) {printf(\"0\\n\"); return 0;}\n\tdp[0] = 1;\n\tfor (ll i=1; i<=n; i++)\n\t\tfor (ll j=0; j<=t-a[i]; j++)\n\t\t\tdp[j + a[i]] = (dp[j + a[i]] + dp[j]) % p;\n\tprintf(\"%d\\n\", dp[t]);\n\treturn 0;\n}"], "input": "", "output": "", "tags": ["dfs and similar", "dp"], "dificulty": "2100", "interactive": false}