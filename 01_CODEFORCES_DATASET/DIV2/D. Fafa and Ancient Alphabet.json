{"link": "https://codeforces.com//contest/935/problem/D", "problemId": "158424", "problem_idx": "D", "shortId": "935D", "contest_number": "935", "problem_submissions": {"E": [35490294, 35492393, 35493358, 35495709, 35495541, 35493647, 35499422, 35499276, 35500262, 35500719, 35500162, 35500658, 35500728, 35499258, 35501222, 35495668, 35497342, 35498886], "D": [35486074, 35488065, 35489775, 35490762, 35489358, 35485225, 35484887, 35488795, 35492000, 35489470, 35491505, 35486948, 35491669, 35491916, 35491520, 35489051, 35488153, 35487210], "C": [35484257, 35486190, 35486639, 35485548, 35486272, 35495170, 35490125, 35484897, 35485714, 35486561, 35487356, 35493330, 35488504, 35487181, 35485279, 35490239], "B": [35480395, 35480198, 35480227, 35479698, 35479918, 35483145, 35479197, 35480428, 35479972, 35480181, 35482318, 35482750, 35481424, 35486459, 35478821, 35479749, 35480541, 35480932], "A": [35478116, 35476883, 35477273, 35476648, 35476835, 35476757, 35476798, 35478023, 35477705, 35477042, 35477472, 35478918, 35478074, 35478028, 35476637, 35476753, 35478890, 35477831], "F": [42089787, 35507058]}, "name": "D. Fafa and Ancient Alphabet", "statement": "Ancient Egyptians are known to have used a large set of symbols to write\r\non the walls of the temples. Fafa and Fifa went to one of the temples\r\nand found two non-empty words and of equal lengths on the wall of temple\r\nwritten one below the other. Since this temple is very ancient, some\r\nsymbols from the words were erased. The symbols in the set have equal\r\nprobability for being in the position of any erased symbol.Fifa\r\nchallenged Fafa to calculate the probability that is lexicographically\r\ngreater than . Can you help Fafa with this task?You know that , i. e.\r\nthere were distinct characters in Egyptians\u2019 alphabet, in this problem\r\nthese characters are denoted by integers from to in alphabet order. A\r\nword is lexicographically greater than a word of the same length, if the\r\nwords are same up to some position, and then the word has a larger\r\ncharacter, than the word .We can prove that the probability equals to\r\nsome fraction , where and are coprime integers, and . Print as the\r\nanswer the value , i. e. such a non-negative integer less than , such\r\nthat , where means that and give the same remainders when divided by .\r\n", "solutions": ["#include <cstdio>\n#include <cstring>\n#include <algorithm>\nusing namespace std;\n\nconst int maxn = 1e5, mod = 1e9 + 7;\n\ninline void Add(int &a, int b) {\n  a += b;\n  if (a >= mod) a -= mod;\n}\n\ninline int Sub(int a) {\n  return a < 0 ? a + mod : a;\n}\n\ninline int Mul(int a, int b) {\n  return (long long)a * b % mod;\n}\n\nint Pow(int a, int b) {\n  int c = 1;\n  for (; b; b >>= 1) {\n    if (b & 1) c = Mul(a, c);\n    a = Mul(a, a);\n  }\n  return c;\n}\n\nint n, m, a[maxn], b[maxn];\n\nint main(void) {\n  scanf(\"%d%d\", &n, &m);\n  for (int i = 0; i < n; ++i) {\n    scanf(\"%d\", a + i);\n  }\n  for (int i = 0; i < n; ++i) {\n    scanf(\"%d\", b + i);\n  }\n  int ans = 0, eql = 1, unit = Pow(m, mod - 2);\n  int tmp = Mul(Sub(1 - unit), Pow(2, mod - 2));\n  for (int i = 0; i < n; ++i) {\n    if (a[i] && b[i]) {\n      if (a[i] < b[i]) {\n        break;\n      } else if (a[i] > b[i]) {\n        Add(ans, eql);\n        break;\n      }\n    } else if (a[i]) {\n      Add(ans, Mul(eql, Mul(a[i] - 1, unit)));\n      eql = Mul(eql, unit);\n    } else if (b[i]) {\n      Add(ans, Mul(eql, Mul(m - b[i], unit)));\n      eql = Mul(eql, unit);\n    } else {\n      Add(ans, Mul(eql, tmp));\n      eql = Mul(eql, unit);\n    }\n  }\n  printf(\"%d\\n\", ans);\n  return 0;\n}\n"], "input": "", "output": "", "tags": ["math", "probabilities"], "dificulty": "1900", "interactive": false}