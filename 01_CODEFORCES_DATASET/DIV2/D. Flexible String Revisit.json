{"link": "https://codeforces.com//contest/1778/problem/D", "problemId": "1760989", "problem_idx": "D", "shortId": "1778D", "contest_number": "1778", "problem_submissions": {"F": [191602138, 191602532, 191585447, 191594114, 191608712, 191599535, 191655210, 191599057, 191639606, 191639396, 194532248, 191803468], "E": [191585870, 191584814, 191630281, 191592729, 191585095, 191596251, 191595141, 191596106, 191592952, 191595620, 191594841, 191592544, 191599842, 192093615, 191596381, 191597065, 191595454], "D": [191578502, 191573421, 191565024, 191574576, 191564042, 191573088, 191575933, 191584703, 191563224, 191573409, 191579570, 191582926, 191579755, 191563101, 191580474, 191576462, 192093593, 191580965, 191580785, 191581424], "C": [191564515, 191569583, 191570422, 191567662, 191567630, 191565698, 191566998, 191565471, 191569851, 191564933, 191565678, 191572047, 191565438, 191575434, 191578186, 191570415, 192093564, 191571887, 191568771, 191569498], "B": [191559138, 191557434, 191555391, 191555255, 191553335, 191555438, 191554286, 191555414, 191559515, 191556063, 191555690, 191562726, 191558781, 191582547, 191561046, 191559475, 192093542, 191562296, 191558152, 191563075], "A": [191546307, 191548742, 191545919, 191546220, 191545819, 191546256, 191546020, 191545963, 191558184, 191545949, 191545987, 191550651, 191554728, 191565464, 191546734, 191548201, 192093519, 191547332, 191546175, 191551024]}, "name": "D. Flexible String Revisit", "statement": "You are given two binary strings a and b of length n. In each move, the\r\nstring a is modified in the following way. An index i (1\r\nleq i\r\nleq n) is chosen uniformly at random. The character a_i will be flipped.\r\nThat is, if a_i is 0, it becomes 1, and if a_i is 1, it becomes 0. What\r\nis the expected number of moves required to make both strings equal ?A\r\nbinary string is a string, in which the character is either\r\ntt{0} or\r\ntt{1}.\r\n", "solutions": ["#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n#define F first\n#define S second\nconst int N=1e6+5,mod=998244353;\nint f[N],g[N],F[N],T,n;\nchar s[N],t[N];\ninline int fastpow(int x, int y){\n\tint z=1;\n\tfor (; y; y>>=1,x=1ll*x*x%mod)\n\t\tif (y&1) z=1ll*z*x%mod;\n\treturn z;\n}\nint main(){\n\tfor (cin>>T; T; T--){\n\t\tscanf(\"%d%s%s\",&n,s+1,t+1);\n\t\tint Invn=fastpow(n,mod-2);\n\t\tf[1]=1ll*(n-1)*Invn%mod; g[1]=1;\n\t\tfor (int i=2; i<n; i++){\n\t\t\tint I=fastpow((1+mod-1ll*Invn*i%mod*f[i-1]%mod)%mod,mod-2);\n\t\t\tf[i]=1ll*I*Invn%mod*(n-i)%mod;\n\t\t\tg[i]=1ll*I*(1+1ll*i*Invn%mod*g[i-1]%mod)%mod;\n\t\t}\n\t\tF[n]=1ll*(g[n-1]+1)*fastpow((1+mod-f[n-1])%mod,mod-2)%mod;\n\t\tfor (int i=n-1; i>=1; i--) F[i]=(1ll*f[i]*F[i+1]+g[i])%mod;\n\t\tint c=0;\n\t\tfor (int i=1; i<=n; i++)\n\t\t\tif (s[i]!=t[i]) c++;\n\t\tif (n==1) printf(\"%d\\n\",c);\n\t\telse printf(\"%d\\n\",F[c]);\n\t\tfor (int i=0; i<=n; i++) f[i]=g[i]=F[i]=0;\n\t}\n}\n/*\n1\n4\n1000\n1110\n*/"], "input": "", "output": "", "tags": ["combinatorics", "dp", "math", "probabilities"], "dificulty": "2100", "interactive": false}