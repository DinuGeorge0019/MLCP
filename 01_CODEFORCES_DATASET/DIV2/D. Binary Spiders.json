{"link": "https://codeforces.com//contest/1625/problem/D", "problemId": "1258602", "problem_idx": "D", "shortId": "1625D", "contest_number": "1625", "problem_submissions": {"E2": [142492395, 142747553, 142585858, 142544817, 142543932, 142508709, 142559014, 142480865], "E1": [142490853, 142508148, 142512533, 142504881, 142515152, 143087068, 142653128, 142500567, 142689991, 142545810, 142545797, 142545556, 142545467, 142545326, 142545262, 142501419, 142513368, 142559018, 142552380, 142479633, 142497816, 142524491, 142499880, 142624103, 142499824, 142519909], "D": [142481572, 142492922, 142487953, 142497240, 142498374, 143087164, 142599139, 142514228, 222453996, 222453785, 142497243, 142486623, 142491954, 142489551, 142492232, 142491133, 142490435, 142499368, 142553310, 142502090, 142500746], "C": [142473156, 142474854, 142475386, 142485242, 142478481, 143087271, 142482654, 142476782, 142498111, 142474938, 142478501, 142483591, 142478318, 142477275, 142483517, 142478815, 142480894, 142480450, 142476700, 142479689], "B": [142469531, 142471088, 142471096, 142472842, 142472506, 143087319, 142469913, 142470866, 142473066, 142471519, 142471936, 142470735, 142472744, 142471752, 142475933, 142471863, 142473722, 142473268, 142472289, 142473807], "A": [142468922, 142469220, 142469548, 142469271, 142469703, 143087364, 142471996, 142469051, 142470684, 142469214, 142469265, 142469095, 142469247, 142469618, 142469909, 142469285, 142470575, 142470471, 142470036, 142469919]}, "name": "D. Binary Spiders", "statement": "Binary Spiders are species of spiders that live on Mars. These spiders\r\nweave their webs to defend themselves from enemies.To weave a web,\r\nspiders join in pairs. If the first spider in pair has x legs, and the\r\nsecond spider has y legs, then they weave a web with x\r\noplus y. Here,\r\noplus means bitwise XOR.Binary Spiders live in large groups. You observe\r\na group of n spiders, and the i-th spider has a_i legs.When the group is\r\nthreatened, some of the spiders become . Defenders are chosen in the\r\nfollowing way. First, there must be at least two defenders. Second, any\r\npair of defenders must be able to weave a web with durability at least\r\nk. Third, there must be as much defenders as possible.Scientists have\r\nresearched the behaviour of Binary Spiders for a long time, and now they\r\nhave a hypothesis that they can always choose the defenders in an\r\noptimal way, satisfying the conditions above. You need to verify this\r\nhypothesis on your group of spiders. So, you need to understand how many\r\nspiders must become defenders. You are not a Binary Spider, so you\r\ndecided to use a computer to solve this problem.\r\n", "solutions": ["#include <bits/stdc++.h>\n#define rep(i,n) for (i=1;i<=(n);i++)\nusing namespace std;\nint n,t,i,k,a[300007];\nint tot,c[9900007][2],id[9900007];\nvector<int> w;\nvoid init(){\n\ttot=1;\n\tc[1][0]=c[1][1]=0;\n}\nvoid ins(int v){\n\tint u=1;\n\tfor(int i=30;i>=0;i--){\n\t\tint o=((a[v]>>i)&1);\n\t\tif(!c[u][o]){\n\t\t\tc[u][o]=++tot;\n\t\t\tc[tot][0]=c[tot][1]=0;\n\t\t}\n\t\tu=c[u][o];\n\t\tid[u]=v;\n\t}\n}\nbool check(int v){\n\tint u=1;\n\tfor(int i=30;i>=0;i--){\n\t\tint o=(((a[v]^k)>>i)&1);\n\t\tif((!((k>>i)&1))&&c[u][!o]){\n\t\t\tw.push_back(id[c[u][!o]]);\n\t\t\tw.push_back(v);\n\t\t\treturn 1;\n\t\t}\n\t\tif(!c[u][o]) return 0;\n\t\tu=c[u][o];\n\t}\n\tw.push_back(id[u]);\n\tw.push_back(v);\n\treturn 1;\n}\nint low(vector<int> v0,vector<int> v1,int d){\n\tinit();\n\tfor(int u:v0) ins(u);\n\tfor(int u:v1) if(check(u)) return 2;\n\tw.push_back(v0.empty()?v1[0]:v0[0]);\n\treturn 1;\n}\nint high(vector<int> v,int d){\n\tif(v.empty()) return 0;\n\tvector<int> v0,v1;\n\tfor(int u:v) if((a[u]>>d)&1) v1.push_back(u); else v0.push_back(u);\n\tif((1<<d)>=k){\n\t\treturn high(v0,d-1)+high(v1,d-1);\n\t}\n\treturn low(v0,v1,d-1);\n}\nint main(){\n\tcin>>n>>k;\n\tif(k==0){\n\t\tcout<<n<<endl;\n\t\trep(i,n) cout<<i<<' ';\n\t\treturn 0;\n\t}\n\tvector<int> v;\n\trep(i,n){\n\t\tcin>>t;\n\t\tv.push_back(i);\n\t\ta[i]=t;\n\t}\n\tint ans=high(v,30);\n\tif(ans>=2){\n\t\tcout<<ans<<endl;\n\t\tfor(int u:w) cout<<u<<' ';\n\t}\n\telse cout<<-1;\n\treturn 0;\n}"], "input": "", "output": "", "tags": ["bitmasks", "data structures", "implementation", "math", "sortings", "trees"], "dificulty": "2300", "interactive": false}