{"link": "https://codeforces.com//contest/828/problem/E", "problemId": "113855", "problem_idx": "E", "shortId": "828E", "contest_number": "828", "problem_submissions": {"A": [28460309, 28447412, 28433654, 28431619, 28432255, 28431175, 28432122, 28431834, 28432270, 28431560, 28438332, 28431659, 28431601, 28431041, 28431462, 28431315, 28448076, 28431218, 28431027], "F": [28448238, 28470827, 28472010, 30446292, 32054149], "E": [28442480, 28440989, 28445030, 28444433, 28441533, 28446059, 28447307, 28490530, 28447795, 28447314, 28449259, 28447763, 28449409, 28448527, 28448262], "D": [28439191, 28443487, 28440542, 28439312, 28444576, 28440699, 28440733, 28440504, 28444280, 28446082, 28441981, 28439597, 28441709, 28443017, 28442903, 28439094, 28443722, 28448787, 28443893], "C": [28435698, 28435500, 28439027, 28435829, 28437161, 28436717, 28438157, 28436695, 28443065, 28454126, 28453810, 28440499, 28438924, 28437102, 28438928, 28438895, 28436411, 28440043, 28437230, 28439797, 28439825, 28439032], "B": [28433895, 28433617, 28434962, 28433706, 28433707, 28434566, 28434207, 28434454, 28435513, 28435599, 28434805, 28433677, 28435479, 28434438, 28432799, 28434943, 28434343, 28435242, 28433224, 28433253]}, "name": "E. DNA Evolution", "statement": "Everyone knows that DNA strands consist of nucleotides. There are four\r\ntypes of nucleotides: \"\", \"\", \"\", \"\". A DNA strand is a sequence of\r\nnucleotides. Scientists decided to track evolution of a rare species,\r\nwhich DNA strand was string initially. Evolution of the species is\r\ndescribed as a sequence of changes in the DNA. Every change is a change\r\nof some nucleotide, for example, the following change can happen in DNA\r\nstrand \"\": the second nucleotide can change to \"\" so that the resulting\r\nDNA strand is \"\".Scientists know that some segments of the DNA strand\r\ncan be affected by some unknown infections. They can represent an\r\ninfection as a sequence of nucleotides. Scientists are interested if\r\nthere are any changes caused by some infections. Thus they sometimes\r\nwant to know the value of impact of some infection to some segment of\r\nthe DNA. This value is computed as follows: Let the infection be\r\nrepresented as a string , and let scientists be interested in DNA strand\r\nsegment starting from position to position , inclusive. Prefix of the\r\nstring (i.e. the string that consists of infinitely many repeats of\r\nstring ) is written under the string from position to position ,\r\ninclusive. The value of impact is the number of positions where letter\r\nof string coincided with the letter written under it. Being a developer,\r\nInnokenty is interested in bioinformatics also, so the scientists asked\r\nhim for help. Innokenty is busy preparing VK Cup, so he decided to\r\ndelegate the problem to the competitors. Help the scientists!\r\n", "solutions": ["#include<bits/stdc++.h>\nchar s[100007],s1[17];\nint*bit[13][13][4];\nint tr[256],ls[13];\nvoid ins(int*f,int mx,int w,int x){\n\tfor(++w;w<=mx;w+=w&-w)f[w]+=x;\n}\nvoid ins(int w,int u,int x){\n\tfor(int i=1;i<=10;++i)ins(bit[i][w%i][u],ls[i],w/i,x);\n}\nint sum(int*f,int w){\n\tint s=0;\n\tfor(++w;w>0;w-=w&-w)s+=f[w];\n\treturn s;\n}\nint sum(int l,int r,int d,int u){\n\tif(l>r)return 0;\n\tr=l+(r-l)/d*d;\n\treturn sum(bit[d][r%d][u],r/d)-sum(bit[d][l%d][u],l/d-1);\n}\nint main(){\n\ttr['A']=0;\n\ttr['T']=1;\n\ttr['G']=2;\n\ttr['C']=3;\n\tscanf(\"%s\",s+1);\n\tint len=strlen(s+1),q,op,l,r;\n\tfor(int i=1;i<=10;++i){\n\t\tls[i]=(len+1000)/i;\n\t\tfor(int j=0;j<i;++j){\n\t\t\tfor(int k=0;k<4;++k){\n\t\t\t\tmemset(bit[i][j][k]=new int[ls[i]],0,sizeof(int)*ls[i]);\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i=1;i<=len;++i)ins(i,tr[s[i]],1);\n\tfor(scanf(\"%d\",&q);q;--q){\n\t\tscanf(\"%d\",&op);\n\t\tif(op==1){\n\t\t\tscanf(\"%d%s\",&l,s1);\n\t\t\tins(l,tr[s[l]],-1);\n\t\t\tins(l,tr[s[l]=s1[0]],1);\n\t\t}else{\n\t\t\tscanf(\"%d%d%s\",&l,&r,s1);\n\t\t\tint L=strlen(s1),ans=0;\n\t\t\tfor(int i=0;i<L;++i){\n\t\t\t\tans+=sum(l+i,r,L,tr[s1[i]]);\n\t\t\t}\n\t\t\tprintf(\"%d\\n\",ans);\n\t\t}\n\t}\n\treturn 0;\n}\n"], "input": "", "output": "", "tags": ["data structures", "strings"], "dificulty": "2100", "interactive": false}