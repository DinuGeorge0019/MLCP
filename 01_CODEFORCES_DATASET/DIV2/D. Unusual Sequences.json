{
    "link": "https://codeforces.com//contest/900/problem/D",
    "problemId": "138317",
    "problem_idx": "D",
    "shortId": "900D",
    "contest_number": "900",
    "problem_submissions": {
        "E": [
            33123004,
            33122209,
            33124223,
            33128027,
            33126296,
            33123992,
            33134877,
            33131568,
            33129839,
            33130568,
            33133529,
            33128615,
            33134512,
            33135377,
            33134229,
            33129907,
            33131645,
            33132271,
            33131644,
            33134967
        ],
        "D": [
            33118613,
            33126606,
            33120228,
            33117273,
            33128904,
            33134754,
            33121668,
            33126110,
            33125759,
            33125945,
            33128804,
            33134849,
            33122370,
            33129223,
            33130838,
            33134832,
            33134143,
            33128551,
            33127657,
            33131147
        ],
        "C": [
            33115963,
            33117760,
            33121163,
            33122923,
            33116908,
            33117063,
            33119169,
            33119501,
            33119408,
            33116545,
            33115888,
            33118394,
            33117100,
            33118026,
            33118964,
            33124120,
            33125946,
            33125772,
            33132467,
            33127142
        ],
        "A": [
            33113471,
            33111416,
            33111216,
            33111936,
            33113195,
            33111439,
            33114180,
            33112223,
            33112487,
            33111223,
            33113441,
            33111156,
            33111069,
            33111686,
            33111630,
            33112745,
            33116326,
            33118751,
            33111288,
            33112610
        ],
        "B": [
            33113418,
            33112919,
            33113915,
            33113361,
            33113043,
            33114488,
            33114219,
            33114774,
            33114387,
            33120138,
            33117548,
            33115087,
            33114887,
            33116028,
            33119460,
            33117688,
            33126678,
            33113193,
            33125132
        ]
    },
    "name": "D. Unusual Sequences",
    "statement": "Count the number of distinct sequences () consisting of positive\r\nintegers such that and . As this number could be large, print the answer\r\nmodulo . here means the greatest common divisor.\r\n",
    "solutions": [
        "#include<bits/stdc++.h>\n#define mod 1000000007\n#define maxn 20\n\nusing namespace std;\ntypedef long long ll;\n\nll gcd(ll x,ll y)\n{\n    if (x%y==0) return y;else return gcd(y,x%y);\n}\n\nll a,b,ans,t,p[maxn],c,m,k,f;\n\nll pow_(ll x,ll y)\n{\n    if (y==0) return 1;\n    ll tmp=pow_(x,y/2);\n    tmp=tmp*tmp%mod;\n    if (y&1) tmp=tmp*x%mod;\n    return tmp;\n}\n\nint main()\n{\n    scanf(\"%d%d\",&a,&b);\n    if (b%a) {printf(\"0\\n\");return 0;}\n    b/=a;c=0; a=b;\n    int j=2;\n    while (j*j<=b){\n        if (b%j==0){\n            p[c++]=j;\n            while (b%j==0) b/=j;\n        }\n        j++;\n    }\n    if (b>1) p[c++]=b;\n    m=(1<<c); ans=0;\n    for (int i=0;i<m;i++)\n    {\n        k=1;t=i;f=1;\n        for (int j=0;j<c;j++)\n        {\n            if (t&1) k*=p[j],f=-f;\n            t>>=1;\n        }\n        ans=(ans+pow_(2,a/k-1)*f)%mod;\n        ans=(ans+mod)%mod;\n    }\n    printf(\"%d\\n\",ans);return 0;\n}\n"
    ],
    "input": "",
    "output": "",
    "tags": [
        "bitmasks",
        "combinatorics",
        "dp",
        "math",
        "number theory"
    ],
    "dificulty": "2000",
    "interactive": false,
    "file_name": "D:\\scoala\\RESEARCH\\MLCP\\01_CODEFORCES_DATASET\\DIV2\\D. Unusual Sequences.json",
    "editorial_link": "https://codeforces.com//blog/entry/56294",
    "editorial": "It\u00e2\u0080\u0099s obvious that if is not divisible by , then the answer is . Let be\r\nthe number of sequences such that their sum is , and is . Then the\r\nanswer for the problem is .How to compute ?. Let\u00e2\u0080\u0099s denote the number of\r\nsequences such that their sum is as . Then is : represent all integers\r\nin the sequence in unary system with zeros, and split them with ones.\r\nNote that , where are divisors of . Then .What\u00e2\u0080\u0099s the complexity?. We\r\nknow that the number of divisors of is not greater than . We can also\r\nnote than every divisor of divisor of is a divisor of . Thus we need for\r\ncompute only for every . Thus computing takes steps when all , are\r\nalready computed. The total complexity is , but on practice it works\r\nmuch faster than one can expect.Also, we can use M bius function to\r\nsolve this problem. This solution has a better complexity, but we will\r\nleave this solution as an exercise for readers.\r\n"
}